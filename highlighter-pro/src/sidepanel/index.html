<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Highlights Manager</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div>
                <h1>üìö My Highlights</h1>
                <div id="syncIndicator" class="sync-indicator"></div>
            </div>
            <div class="header-actions">
                <button id="exportBtn" class="btn-icon" title="Export">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                </button>
                <button id="importBtn" class="btn-icon" title="Import">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                </button>
                <button id="syncBtn" class="btn-icon" title="Sync with GitHub">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
                    </svg>
                </button>
                <button id="settingsBtn" class="btn-icon" title="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v6m0 6v6m6-6h6M6 12H1m14.95-6.36l4.24-4.24M3.81 20.19l4.24-4.24m0-8.48L3.81 3.81m16.38 16.38l-4.24-4.24"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Toolbar -->
        <div class="toolbar">
            <input type="text" id="searchInput" placeholder="üîç Search highlights..." class="search-input">
            
            <div class="filter-group">
                <label>Filter by color:</label>
                <div class="color-filters">
                    <button class="color-filter active" data-color="all" title="All">All</button>
                    <button class="color-filter" data-color="yellow" style="background: #ffeb3b;" title="Yellow"></button>
                    <button class="color-filter" data-color="cyan" style="background: #00bcd4;" title="Cyan"></button>
                    <button class="color-filter" data-color="lime" style="background: #cddc39;" title="Lime"></button>
                    <button class="color-filter" data-color="magenta" style="background: #e91e63;" title="Magenta"></button>
                </div>
            </div>

            <div class="view-toggle">
                <label>View:</label>
                <select id="viewMode">
                    <option value="page">Current Page</option>
                    <option value="domain">Current Domain</option>
                    <option value="all">All Highlights</option>
                </select>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats">
            <div class="stat-item">
                <span class="stat-label">Total:</span>
                <span id="totalCount" class="stat-value">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Filtered:</span>
                <span id="filteredCount" class="stat-value">0</span>
            </div>
        </div>

        <!-- Highlights List -->
        <div id="highlightsList" class="highlights-list">
            <!-- Will be populated by JavaScript -->
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state" style="display: none;">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
            </svg>
            <p>No highlights found</p>
            <small>Start highlighting text on any webpage!</small>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Export Highlights</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <button class="export-option" data-format="json">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        <h3>JSON</h3>
                        <p>For backup & sync</p>
                    </button>
                    <button class="export-option" data-format="csv">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="9" y1="15" x2="15" y2="15"></line>
                        </svg>
                        <h3>CSV</h3>
                        <p>For Excel & Sheets</p>
                    </button>
                    <button class="export-option" data-format="markdown">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <path d="M10 13l-2 2 2 2"></path>
                            <path d="M14 13l2 2-2 2"></path>
                        </svg>
                        <h3>Markdown</h3>
                        <p>For Notion/Obsidian</p>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div id="importModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Import Highlights</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="import-area">
                    <input type="file" id="fileInput" accept=".json" style="display: none;">
                    <button id="selectFileBtn" class="btn-primary">
                        Select JSON File
                    </button>
                    <div id="fileInfo" style="display: none; margin-top: 15px;">
                        <p id="fileName"></p>
                        <button id="importFileBtn" class="btn-primary">Import</button>
                    </div>
                </div>
                <div class="import-warning">
                    <strong>‚ö†Ô∏è Warning:</strong> Importing will merge with existing highlights. Duplicates will be avoided based on UUID.
                </div>
            </div>
        </div>
    </div>

    <!-- Sync Settings Modal -->
    <div id="syncModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>GitHub Sync Settings</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="githubToken">GitHub Personal Access Token:</label>
                    <input type="password" id="githubToken" placeholder="ghp_...">
                    <small>Need token? <a href="https://github.com/settings/tokens/new" target="_blank">Create one here</a> with 'repo' scope</small>
                </div>
                <div class="form-group">
                    <label for="githubRepo">Repository (username/repo):</label>
                    <input type="text" id="githubRepo" placeholder="username/highlights-sync">
                </div>
                <div class="form-group">
                    <label for="githubFile">File path:</label>
                    <input type="text" id="githubFile" placeholder="highlights.json" value="highlights.json">
                </div>
                
                <div class="form-group auto-sync-settings">
                    <div class="toggle-container">
                        <label for="autoSyncToggle">
                            <input type="checkbox" id="autoSyncToggle" checked>
                            <span class="toggle-label">Enable Auto-Sync</span>
                        </label>
                    </div>
                    <small>Automatically sync every few minutes when changes are detected</small>
                </div>
                
                <div class="form-group" id="autoSyncIntervalGroup">
                    <label for="autoSyncInterval">Auto-sync interval:</label>
                    <select id="autoSyncInterval">
                        <option value="1">Every 1 minute</option>
                        <option value="5" selected>Every 5 minutes</option>
                        <option value="10">Every 10 minutes</option>
                        <option value="15">Every 15 minutes</option>
                        <option value="30">Every 30 minutes</option>
                    </select>
                </div>
                
                <div class="sync-actions">
                    <button id="saveSyncSettings" class="btn-primary">Save Settings</button>
                    <button id="pushToGithub" class="btn-secondary" disabled>Push to GitHub</button>
                    <button id="pullFromGithub" class="btn-secondary" disabled>Pull from GitHub</button>
                </div>
                
                <div class="backup-section">
                    <h3>Local Backups</h3>
                    <p class="backup-info">Auto-sync creates local backups before pulling new data</p>
                    <button id="viewBackups" class="btn-secondary">View Backups</button>
                </div>
                
                <div id="syncStatus" class="sync-status"></div>
            </div>
        </div>
    </div>

    <!-- Edit Highlight Modal -->
    <div id="editModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Highlight</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="editNote">Note:</label>
                    <textarea id="editNote" rows="4" placeholder="Add your note here..."></textarea>
                </div>
                <div class="form-group">
                    <label for="editTags">Tags (comma separated):</label>
                    <input type="text" id="editTags" placeholder="important, research, todo">
                </div>
                <div class="modal-actions">
                    <button id="saveEdit" class="btn-primary">Save</button>
                    <button id="cancelEdit" class="btn-secondary">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Backups Modal -->
    <div id="backupsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Local Backups</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div id="backupsList" class="backups-list">
                    <!-- Will be populated by JavaScript -->
                </div>
                <div id="noBackups" class="empty-state" style="display: none;">
                    <p>No backups found</p>
                    <small>Backups are created automatically when pulling from GitHub</small>
                </div>
            </div>
        </div>
    </div>

    <script src="index.js"></script>
</body>
</html>
