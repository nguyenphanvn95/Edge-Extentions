import"./modulepreload-polyfill-B5Qt9EMX.js";import{r as h,v as w,o as b,X as Te,Y as Le,d as C,a as m,c as T,j as p,D as g,w as v,f as i,t as H,Z as O,E as De,$ as Me,a0 as ze,a1 as Ve,I as Ae,K as Oe,L as We,k as x,G as _,p as L,e as U,R as G,s as $e,U as Re,V as D,W as je}from"./global-BC8dNUmM.js";import{e as W,d as Ne,a as qe,r as K,_ as M,o as $,q as X,P as Be,t as Y,s as Z,S as He,i as Ue,p as Ge,w as Ke}from"./slide.vue_vue_type_script_setup_true_lang-CAYDEUGR.js";import{l as J}from"./lodash-D3Y-mkk_.js";import{a as Xe,v as Q,w as ee,E as Ye}from"./utils-CBRNvm1S.js";import{w as Ze,x as Je}from"./config-Br0JWhEe.js";import{g as Qe,a as et,b as tt,c as at}from"./config-Hi3Bg2Cg.js";import"./const-Bl3AZojp.js";(async()=>{const z=W("fullScreen",()=>{const s=h(!1),a=(o=document.documentElement)=>{s.value?l():r(o),s.value=!s.value},r=o=>{o.requestFullscreen&&o.requestFullscreen()},l=()=>{document.exitFullscreen&&document.exitFullscreen()};return{isFullScreen:s,toggleFullScreen:a,setFullScreen:o=>{s.value=o}}}),I=W("pageControl",()=>{const s=h(1),a=h(1),r=h({}),l=h(!1),o=d=>`side-page-${d}`,e=d=>`main-page-${d}`,t=()=>document.getElementById(e(a.value)),n=()=>document.getElementById(o(a.value)),c=async()=>{const d=t();d&&(l.value=!0,d.scrollIntoView({block:"center"}),await new Promise(F=>setTimeout(F,1e3)),l.value=!1)},f=()=>{const d=n();d&&d.scrollIntoView({behavior:"smooth",block:"center"})},u=(d,F)=>{if(r.value[d]=F,l.value)return!1;let P;for(const S in r.value)P||(P=Number(S)),r.value[S]>r.value[P]&&(P=Number(S));return P&&P!==a.value&&(a.value=P,f()),!0},E=d=>d<1||d>s.value?!1:(a.value=d,c(),f(),!0);return{getSidePageId:o,getMainPageId:e,selectPage:E,selectNextPage:()=>{a.value+1<=s.value&&E(a.value+1)},selectPreviousPage:()=>{a.value-1>=1&&E(a.value-1)},getCurrentPage:t,getCurrentIndex:()=>a.value,scrollPage:u,setTotal:d=>{s.value=d},getTotal:()=>s.value}}),V=W("scale",()=>{const s=h(100),a=t=>{const n=J.clamp(J.round(t),25,200);n!==s.value&&(s.value=n)},r=(t=5)=>{a(s.value+t)},l=(t=5)=>{a(s.value-t)},o=t=>{a(t*100)},e=w(()=>s.value/100);return{scalePercent:s,setScalePercent:a,setScale:o,addScalePercent:r,subScalePercent:l,scale:e}}),R="full-screen-overlay";function te(){const s=z(),{cleanPageContent:a}=A(),r=()=>{const l=!!document.fullscreenElement;l||a(),s.setFullScreen(l)};return b(()=>{document.addEventListener("fullscreenchange",r)}),Te(()=>{document.removeEventListener("fullscreenchange",r)}),{}}function j(){const{selectNextPage:s,selectPreviousPage:a}=I(),r=z(),{toggleFullScreen:l,updatePageContent:o}=A(),e=()=>{s(),r.isFullScreen&&o()},t=()=>{a(),r.isFullScreen&&o()},n=u=>{u.key===" "&&(u.preventDefault(),u.stopPropagation(),e()),(u.key==="ArrowLeft"||u.key==="ArrowUp")&&(u.preventDefault(),u.stopPropagation(),t()),(u.key==="ArrowRight"||u.key==="ArrowDown")&&(u.preventDefault(),u.stopPropagation(),e()),u.key==="Enter"&&(u.preventDefault(),u.stopPropagation(),l())},c=()=>{document.addEventListener("keydown",n)},f=()=>{document.removeEventListener("keydown",n)};b(()=>{c()}),Le(()=>{f()})}function A(){const s=z(),{getCurrentPage:a}=I(),r=()=>{s.isFullScreen?(t(),s.setFullScreen(!1)):(e(),s.setFullScreen(!0))},l=()=>{const n=a(),c=document.getElementById(R);if(n&&c){const f=n.cloneNode(!0);c.innerHTML="",c.appendChild(f)}return c},o=()=>{const n=document.getElementById(R);n&&(n.innerHTML="")},e=()=>{const n=l();n&&n.requestFullscreen&&n.requestFullscreen()},t=()=>{document.exitFullscreen&&(o(),document.exitFullscreen())};return{toggleFullScreen:r,updatePageContent:l,cleanPageContent:o}}const ae={class:"flex items-center justify-between w-full relative h-full px-4"},ne={class:"flex items-center gap-4"},re={class:"absolute left-1/2 transform -translate-x-1/2 flex flex-row items-center gap-4 text-xs"},le={class:"flex items-center gap-2"},se=["value"],oe={class:"flex items-center gap-2"},ce=["value"],ie={class:"flex items-center gap-4"},ue=C({__name:"Header",props:{title:{}},setup(s){const a=Ne();te();const{toggleFullScreen:r}=A(),l=I(),o=()=>{},e=V(),t=w(()=>`${e.scalePercent}%`),n=w(()=>l.getCurrentIndex()),c=w(()=>l.getTotal()),f=()=>{e.addScalePercent()},u=()=>{e.subScalePercent()},E=async()=>{await qe().download()},d=()=>{a.rerender()},F=()=>{r(),chrome.runtime.sendMessage({action:Xe,activityType:"play_slide"})},P=S=>{const k=S.target.value;if(k)try{const y=parseInt(k);l.selectPage(y)}catch{}};return(S,k)=>{const y=De;return m(),T("div",ae,[p("div",ne,[g(y,{class:"cursor-pointer",onClick:o,size:20},{default:v(()=>[g(i(Me))]),_:1}),p("p",null,H(S.title),1)]),p("div",re,[p("div",le,[p("input",{class:"bg-neutral-800 text-center text-white w-14 p-[2px]",type:"text",value:i(n),style:O({width:`${i(c).toString().length*1.5}ch`}),onInput:P},null,44,se),k[0]||(k[0]=p("p",{class:"text-center"},"/",-1)),p("p",null,H(i(c)),1)]),k[1]||(k[1]=p("div",{class:"border-r border-neutral-500 h-4"},null,-1)),p("div",oe,[g(y,{size:12,onClick:u,class:"cursor-pointer"},{default:v(()=>[g(i(ze))]),_:1}),p("input",{class:"bg-neutral-800 text-center text-white w-[6ch] p-[2px]",type:"text",value:i(t)},null,8,ce),g(y,{size:12,onClick:f,class:"cursor-pointer"},{default:v(()=>[g(i(Ve))]),_:1})])]),p("div",ie,[g(y,{class:"cursor-pointer",onClick:F,size:20},{default:v(()=>[g(i(Ae))]),_:1}),g(y,{class:"cursor-pointer",onClick:E,size:20},{default:v(()=>[g(i(Oe))]),_:1}),g(y,{class:"cursor-pointer",onClick:d,size:20},{default:v(()=>[g(i(We))]),_:1})])])}}}),de=C({__name:"Side",props:{article:{},renderConfig:{},userConfig:{}},setup(s){const{getSidePageId:a,selectPage:r,setTotal:l,getCurrentIndex:o}=I();return L("pageOperation",{getPageId:a,selectPage:r,setTotal:l,getCurrentIndex:o}),(e,t)=>e.article?(m(),x(M,{key:0,"max-width":250,padding:32},{default:v(({maxWidth:n})=>{var c;return[g(K,{article:e.article,"max-width":n,"render-config":e.renderConfig,separator:(c=e.userConfig)==null?void 0:c.separator,"can-download":""},null,8,["article","max-width","render-config","separator"])]}),_:1})):_("",!0)}}),ge=C({__name:"Container",props:{article:{},renderConfig:{},userConfig:{}},setup(s){const a=s,{getMainPageId:r,scrollPage:l}=I();L("pageOperation",{getPageId:r,scrollPage:l});const o=V(),e=w(()=>o.scale);return b(()=>{const t=window.innerWidth,n=a.renderConfig.width,c=(t-250-32*4)/n;o.setScale(Math.min(1,c))}),(t,n)=>t.article?(m(),x(M,{key:0,padding:32},{default:v(({maxWidth:c})=>{var f;return[g(K,{scale:i(e),article:t.article,"max-width":c,"render-config":t.renderConfig,separator:(f=t.userConfig)==null?void 0:f.separator,"can-download":""},null,8,["scale","article","max-width","render-config","separator"])]}),_:1})):_("",!0)}}),fe={},pe={class:"flex flex-row h-full"},me={class:"flex flex-col items-center w-[250px] border-r border-neutral-700 h-full overflow-auto"},ve={class:"flex-1 flex flex-col items-center h-full overflow-auto"};function we(s,a){return m(),T("div",pe,[p("div",me,[U(s.$slots,"sidebar")]),p("div",ve,[U(s.$slots,"main")])])}const N=$(fe,[["render",we]]),he=C({__name:"View",props:{article:{}},setup(s){const a=X(),r=h(),l=w(()=>new Be(a.config));j();const o=w(()=>{const e=l.value.width,t=l.value.height,n=window.screen.width,c=window.screen.height,f=n/e,u=c/t;return{"--scale":Math.min(f,u).toString()}});return b(async()=>{const e=await Qe();if(e){X().saveConfig(e);const t=e.font;Q(ee(t))}r.value=await et()}),(e,t)=>(m(),T(G,null,[g(i(N),null,{sidebar:v(()=>[e.article?(m(),x(de,{key:0,article:e.article,"render-config":i(l),"user-config":i(r)},null,8,["article","render-config","user-config"])):_("",!0)]),main:v(()=>[e.article?(m(),x(ge,{key:0,article:e.article,"render-config":i(l),"user-config":i(r)},null,8,["article","render-config","user-config"])):_("",!0)]),_:1}),p("div",{id:"full-screen-overlay",class:"flex flex-col items-center justify-center",style:O(i(o))},null,4)],64))}}),xe=$(he,[["__scopeId","data-v-7ca05eba"]]),_e=C({__name:"Side",props:{article:{},renderConfig:{},userConfig:{}},setup(s){const{getSidePageId:a,selectPage:r,setTotal:l,getCurrentIndex:o}=I();return L("pageOperation",{getPageId:a,selectPage:r,setTotal:l,getCurrentIndex:o}),(e,t)=>e.article?(m(),x(M,{key:0,"max-width":250,padding:32},{default:v(({maxWidth:n})=>{var c;return[g(Y,{article:e.article,"max-width":n,"render-config":e.renderConfig,separator:(c=e.userConfig)==null?void 0:c.separator,"can-download":""},null,8,["article","max-width","render-config","separator"])]}),_:1})):_("",!0)}}),Pe=C({__name:"Container",props:{article:{},renderConfig:{},userConfig:{}},setup(s){const a=s,{getMainPageId:r,scrollPage:l}=I();L("pageOperation",{getPageId:r,scrollPage:l});const o=V(),e=w(()=>o.scale);return b(()=>{const t=window.innerWidth,n=a.renderConfig.width,c=(t-250-32*4)/n;o.setScale(Math.min(1,c))}),(t,n)=>t.article?(m(),x(M,{key:0,padding:32},{default:v(({maxWidth:c})=>{var f;return[g(Y,{scale:i(e),article:t.article,"max-width":c,"render-config":t.renderConfig,separator:(f=t.userConfig)==null?void 0:f.separator,"can-download":""},null,8,["scale","article","max-width","render-config","separator"])]}),_:1})):_("",!0)}}),ye=C({__name:"View",props:{article:{}},setup(s){const a=Z(),r=h(),l=w(()=>new He(a.config));j();const o=w(()=>{const e=l.value.width,t=l.value.height,n=window.screen.width,c=window.screen.height,f=n/e,u=c/t;return{"--scale":Math.min(f,u).toString()}});return b(async()=>{const e=await tt();if(e){Z().saveConfig(e);const t=e.font;Q(ee(t))}r.value=await at()}),(e,t)=>(m(),T(G,null,[g(i(N),null,{sidebar:v(()=>[e.article?(m(),x(_e,{key:0,article:e.article,"render-config":i(l),"user-config":i(r)},null,8,["article","render-config","user-config"])):_("",!0)]),main:v(()=>[e.article?(m(),x(Pe,{key:0,article:e.article,"render-config":i(l),"user-config":i(r)},null,8,["article","render-config","user-config"])):_("",!0)]),_:1}),p("div",{id:"full-screen-overlay",class:"flex flex-col items-center justify-center",style:O(i(o))},null,4)],64))}}),Ce=$(ye,[["__scopeId","data-v-6eb2048b"]]),Ie={class:"text-base bg-neutral-900 text-white"},Se={class:"sticky top-0 z-10 shadow bg-neutral-800 h-[50px]"},ke={class:"h-[calc(100vh-50px)] overflow-auto"},be=C({__name:"main",setup(s){const a=h(),r=h(),l=w(()=>{var t,n;return((n=(t=r.value)==null?void 0:t.title.content)==null?void 0:n.concatText)??""}),{t:o}=$e(),e=w(()=>o("setting.template.tag.label"));return b(async()=>{const t=window.location.hash;t==="#pdf"?a.value="pdf":t==="#slide"&&(a.value="slide"),await Ue().init(!1),Ze().then(n=>{n&&Ge(n,e.value,!1).then(c=>{r.value=c})})}),(t,n)=>(m(),T("main",Ie,[p("div",Se,[g(ue,{title:i(l)},null,8,["title"])]),p("div",ke,[i(a)==="pdf"?(m(),x(xe,{key:0,article:i(r)},null,8,["article"])):_("",!0),i(a)==="slide"?(m(),x(Ce,{key:1,article:i(r)},null,8,["article"])):_("",!0)])]))}});let q=Ye();const B=await Je();B&&(q=B.locale);const Ee=Re({locale:q,fallbackLocale:"en",messages:{en:await D(()=>import("./en-B56In8mj.js"),[]),"zh-hans":await D(()=>import("./zh-hans-DfnptakB.js"),[]),"zh-hant":await D(()=>import("./zh-hant-Cx-hT51-.js"),[]),ja:await D(()=>import("./ja-MMbLbmmh.js"),[])}}),Fe=Ke();je(be).use(Ee).use(Fe).mount("#app")})();
