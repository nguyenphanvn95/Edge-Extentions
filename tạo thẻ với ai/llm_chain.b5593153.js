var e,r;"function"==typeof(e=globalThis.define)&&(r=e,e=null),function(r,t,s,a,n){var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i="function"==typeof o[a]&&o[a],l=i.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(e,t){if(!l[e]){if(!r[e]){var s="function"==typeof o[a]&&o[a];if(!t&&s)return s(e,!0);if(i)return i(e,!0);if(c&&"string"==typeof e)return c(e);var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}d.resolve=function(t){var s=r[e][1][t];return null!=s?s:t},d.cache={};var p=l[e]=new u.Module(e);r[e][0].call(p.exports,d,p,p.exports,this)}return l[e].exports;function d(e){var r=d.resolve(e);return!1===r?{}:u(r)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=r,u.cache=l,u.parent=i,u.register=function(e,t){r[e]=[function(e,r){r.exports=t},{}]},Object.defineProperty(u,"root",{get:function(){return o[a]}}),o[a]=u;for(var p=0;p<t.length;p++)u(t[p]);if(s){var d=u(s);"object"==typeof exports&&"undefined"!=typeof module?module.exports=d:"function"==typeof e&&e.amd&&e(function(){return d})}}({"2maZX":[function(e,r,t){e("222a9686624d07af").register(JSON.parse('{"lmlKL":"llm_chain.b5593153.js","luRQj":"sequential_chain.abf44761.js","3qIni":"combine_docs_chain.e28abceb.js","lBkr1":"few_shot.d0824def.js","ceGYv":"prompt.f63a3ee1.js","goC8E":"vector_db_qa.44b38212.js","jXHDk":"api_chain.e0853eca.js"}'))},{"222a9686624d07af":"3OylR"}],"3OylR":[function(e,r,t){var s={};r.exports.register=function(e){for(var r=Object.keys(e),t=0;t<r.length;t++)s[r[t]]=e[r[t]]},r.exports.resolve=function(e){var r=s[e];if(null==r)throw Error("Could not resolve bundle with id "+e);return r}},{}],dLYP0:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"LLMChain",()=>c);var a=e("./base.js"),n=e("../prompts/base.js"),o=e("../base_language/index.js"),i=e("../output_parsers/noop.js"),l=e("../schema/runnable/base.js");class c extends a.BaseChain{static lc_name(){return"LLMChain"}get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new i.NoOpOutputParser,this.prompt.outputParser){if(e.outputParser)throw Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}getCallKeys(){return"callKeys"in this.llm?this.llm.callKeys:[]}_selectMemoryInputs(e){let r=super._selectMemoryInputs(e);for(let t of this.getCallKeys())t in e&&delete r[t];return r}async _getFinalOutput(e,r,t){return this.outputParser?await this.outputParser.parseResultWithPrompt(e,r,t?.getChild()):e[0].text}call(e,r){return super.call(e,r)}async _call(e,r){let t={...e},s={...this.llmKwargs};for(let r of this.getCallKeys())r in e&&s&&(s[r]=e[r],delete t[r]);let a=await this.prompt.formatPromptValue(t);if("generatePrompt"in this.llm){let{generations:e}=await this.llm.generatePrompt([a],s,r?.getChild());return{[this.outputKey]:await this._getFinalOutput(e[0],a,r)}}let n=this.outputParser?this.llm.pipe(this.outputParser):this.llm,o=await n.invoke(a,r?.getChild());return{[this.outputKey]:o}}async predict(e,r){return(await this.call(e,r))[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){let{llm:r,prompt:t}=e;if(!r)throw Error("LLMChain must have llm");if(!t)throw Error("LLMChain must have prompt");return new c({llm:await (0,o.BaseLanguageModel).deserialize(r),prompt:await (0,n.BasePromptTemplate).deserialize(t)})}serialize(){let e="serialize"in this.llm?this.llm.serialize():void 0;return{_type:`${this._chainType()}_chain`,llm:e,prompt:this.prompt.serialize()}}_getNumTokens(e){return(function e(r){if("function"==typeof r._llmType)return r;if("bound"in r&&(0,l.Runnable).isRunnable(r.bound))return e(r.bound);if("runnable"in r&&"fallbacks"in r&&(0,l.Runnable).isRunnable(r.runnable))return e(r.runnable);if("default"in r&&(0,l.Runnable).isRunnable(r.default))return e(r.default);throw Error("Unable to extract BaseLanguageModel from llmLike object.")})(this.llm).getNumTokens(e)}}},{"./base.js":"lOD6l","../prompts/base.js":"8VjQL","../base_language/index.js":"lXz6C","../output_parsers/noop.js":"eQKjp","../schema/runnable/base.js":"1k6RL","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],lOD6l:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BaseChain",()=>i);var a=e("../schema/index.js"),n=e("../callbacks/manager.js"),o=e("../base_language/index.js");class i extends o.BaseLangChain{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,r,t){if(1!=arguments.length||"object"!=typeof e||"saveContext"in e)super({verbose:r,callbacks:t}),this.memory=e;else{let{memory:r,callbackManager:t,...s}=e;super({...s,callbacks:t??s.callbacks}),this.memory=r}}_selectMemoryInputs(e){let r={...e};return"signal"in r&&delete r.signal,"timeout"in r&&delete r.timeout,r}async invoke(e,r){return this.call(e,r)}_validateOutputs(e){let r=this.outputKeys.filter(r=>!(r in e));if(r.length)throw Error(`Missing output keys: ${r.join(", ")} from chain ${this._chainType()}`)}async prepOutputs(e,r,t=!1){return(this._validateOutputs(r),this.memory&&await this.memory.saveContext(e,r),t)?r:{...e,...r}}serialize(){throw Error("Method not implemented.")}async run(e,r){let t=this.inputKeys.filter(e=>!this.memory?.memoryKeys.includes(e)??!0);if(!(t.length<=1))throw Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);let s=t.length?{[t[0]]:e}:{},a=await this.call(s,r),n=Object.keys(a);if(1===n.length)return a[n[0]];throw Error("return values have multiple keys, `run` only supported when one key currently")}async _formatValues(e){let r={...e};if(r.timeout&&!r.signal&&(r.signal=AbortSignal.timeout(r.timeout),delete r.timeout),null!=this.memory)for(let[t,s]of Object.entries(await this.memory.loadMemoryVariables(this._selectMemoryInputs(e))))r[t]=s;return r}async call(e,r,t){let s;let o=await this._formatValues(e),i=(0,n.parseCallbackConfigArg)(r),l=await (0,n.CallbackManager).configure(i.callbacks,this.callbacks,i.tags||t,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),c=await l?.handleChainStart(this.toJSON(),o,void 0,void 0,void 0,void 0,i.runName);try{s=await (e.signal?Promise.race([this._call(o,c),new Promise((r,t)=>{e.signal?.addEventListener("abort",()=>{t(Error("AbortError"))})})]):this._call(o,c))}catch(e){throw await c?.handleChainError(e),e}return null!=this.memory&&await this.memory.saveContext(this._selectMemoryInputs(e),s),await c?.handleChainEnd(s),Object.defineProperty(s,a.RUN_KEY,{value:c?{runId:c?.runId}:void 0,configurable:!0}),s}async apply(e,r){return Promise.all(e.map(async(e,t)=>this.call(e,r?.[t])))}static async deserialize(r,t={}){switch(r._type){case"llm_chain":{let{LLMChain:t}=await e("2d811e2b51cdeee3");return t.deserialize(r)}case"sequential_chain":{let{SequentialChain:t}=await e("35f78524e5fc8f7c");return t.deserialize(r)}case"simple_sequential_chain":{let{SimpleSequentialChain:t}=await e("35f78524e5fc8f7c");return t.deserialize(r)}case"stuff_documents_chain":{let{StuffDocumentsChain:t}=await e("97a14159688e6a69");return t.deserialize(r)}case"map_reduce_documents_chain":{let{MapReduceDocumentsChain:t}=await e("97a14159688e6a69");return t.deserialize(r)}case"refine_documents_chain":{let{RefineDocumentsChain:t}=await e("97a14159688e6a69");return t.deserialize(r)}case"vector_db_qa":{let{VectorDBQAChain:s}=await e("2c1a009b6d0f14cc");return s.deserialize(r,t)}case"api_chain":{let{APIChain:t}=await e("4a543ae243292fe");return t.deserialize(r)}default:throw Error(`Invalid prompt type in config: ${r._type}`)}}}},{"../schema/index.js":"bkgD3","../callbacks/manager.js":"50XG0","../base_language/index.js":"lXz6C","2d811e2b51cdeee3":"lJbk3","35f78524e5fc8f7c":"fZFYW","97a14159688e6a69":"eneXk","2c1a009b6d0f14cc":"d09x5","4a543ae243292fe":"ePxvh","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],bkgD3:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"RUN_KEY",()=>o.RUN_KEY),s.export(t,"BaseMessageChunk",()=>a.BaseMessageChunk),s.export(t,"HumanMessageChunk",()=>a.HumanMessageChunk),s.export(t,"AIMessageChunk",()=>a.AIMessageChunk),s.export(t,"SystemMessageChunk",()=>a.SystemMessageChunk),s.export(t,"FunctionMessage",()=>a.FunctionMessage),s.export(t,"FunctionMessageChunk",()=>a.FunctionMessageChunk),s.export(t,"ToolMessage",()=>a.ToolMessage),s.export(t,"ToolMessageChunk",()=>a.ToolMessageChunk),s.export(t,"ChatMessage",()=>a.ChatMessage),s.export(t,"mapStoredMessageToChatMessage",()=>a.mapStoredMessageToChatMessage),s.export(t,"ChatMessageChunk",()=>a.ChatMessageChunk),s.export(t,"coerceMessageLikeToMessage",()=>a.coerceMessageLikeToMessage),s.export(t,"isBaseMessage",()=>a.isBaseMessage),s.export(t,"isBaseMessageChunk",()=>a.isBaseMessageChunk),s.export(t,"GenerationChunk",()=>o.GenerationChunk),s.export(t,"ChatGenerationChunk",()=>o.ChatGenerationChunk),s.export(t,"BasePromptValue",()=>i.BasePromptValue),s.export(t,"BaseChatMessageHistory",()=>l.BaseChatMessageHistory),s.export(t,"BaseListChatMessageHistory",()=>l.BaseListChatMessageHistory),s.export(t,"BaseCache",()=>c.BaseCache),s.export(t,"BaseMessage",()=>a.BaseMessage),s.export(t,"HumanMessage",()=>a.HumanMessage),s.export(t,"AIMessage",()=>a.AIMessage),s.export(t,"SystemMessage",()=>a.SystemMessage),s.export(t,"BaseChatMessage",()=>u),s.export(t,"HumanChatMessage",()=>p),s.export(t,"AIChatMessage",()=>d),s.export(t,"SystemChatMessage",()=>h),s.export(t,"BaseFileStore",()=>f),s.export(t,"BaseEntityStore",()=>m),s.export(t,"Docstore",()=>b);var a=e("@langchain/core/messages"),n=e("../load/serializable.js"),o=e("@langchain/core/outputs"),i=e("@langchain/core/prompt_values"),l=e("@langchain/core/chat_history"),c=e("@langchain/core/caches");let u=a.BaseMessage,p=a.HumanMessage,d=a.AIMessage,h=a.SystemMessage;class f extends n.Serializable{}class m extends n.Serializable{}class b{}},{"@langchain/core/messages":"kbDCa","../load/serializable.js":"de04K","@langchain/core/outputs":"5QXQB","@langchain/core/prompt_values":"fyYr2","@langchain/core/chat_history":"czIUX","@langchain/core/caches":"7eTvu","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],kbDCa:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/messages/index.js");s.exportAll(a,t)},{"./dist/messages/index.js":"3Jjkr","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],de04K:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("@langchain/core/load/serializable");s.exportAll(a,t)},{"@langchain/core/load/serializable":"hR7OG","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],hR7OG:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("../dist/load/serializable.js");s.exportAll(a,t)},{"../dist/load/serializable.js":"MmHAq","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"5QXQB":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/outputs.js");s.exportAll(a,t)},{"./dist/outputs.js":"cXWxZ","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],cXWxZ:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"RUN_KEY",()=>a),s.export(t,"GenerationChunk",()=>n),s.export(t,"ChatGenerationChunk",()=>o);let a="__run";class n{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new n({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class o extends n{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new o({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],fyYr2:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/prompt_values.js");s.exportAll(a,t)},{"./dist/prompt_values.js":"bLGqd","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],czIUX:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/chat_history.js");s.exportAll(a,t)},{"./dist/chat_history.js":"5PzbK","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"5PzbK":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BaseChatMessageHistory",()=>o),s.export(t,"BaseListChatMessageHistory",()=>i);var a=e("./load/serializable.js"),n=e("./messages/index.js");class o extends a.Serializable{}class i extends a.Serializable{addUserMessage(e){return this.addMessage(new n.HumanMessage(e))}addAIChatMessage(e){return this.addMessage(new n.AIMessage(e))}}},{"./load/serializable.js":"MmHAq","./messages/index.js":"3Jjkr","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"7eTvu":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/caches.js");s.exportAll(a,t)},{"./dist/caches.js":"ei2vN","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],ei2vN:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"getCacheKey",()=>o),s.export(t,"deserializeStoredGeneration",()=>i),s.export(t,"serializeGeneration",()=>l),s.export(t,"BaseCache",()=>c),s.export(t,"InMemoryCache",()=>p);var a=e("./utils/hash.js"),n=e("./messages/index.js");let o=(...e)=>(0,a.insecureHash)(e.join("_"));function i(e){return void 0!==e.message?{text:e.text,message:(0,n.mapStoredMessageToChatMessage)(e.message)}:{text:e.text}}function l(e){let r={text:e.text};return void 0!==e.message&&(r.message=e.message.toDict()),r}class c{}let u=new Map;class p extends c{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,r){return Promise.resolve(this.cache.get(o(e,r))??null)}async update(e,r,t){this.cache.set(o(e,r),t)}static global(){return new p(u)}}},{"./utils/hash.js":"cWfd8","./messages/index.js":"3Jjkr","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],cWfd8:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"insecureHash",()=>a.insecureHash);var a=e("./js-sha1/hash.js")},{"./js-sha1/hash.js":"fzTTX","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],fzTTX:[function(e,r,t){/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"insecureHash",()=>u);var a="object"==typeof window?window:{},n="0123456789abcdef".split(""),o=[-2147483648,8388608,32768,128],i=[24,16,8,0],l=[];function c(e){e?(l[0]=l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0,this.blocks=l):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}c.prototype.update=function(e){if(!this.finalized){var r="string"!=typeof e;r&&e.constructor===a.ArrayBuffer&&(e=new Uint8Array(e));for(var t,s,n=0,o=e.length||0,l=this.blocks;n<o;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),r)for(s=this.start;n<o&&s<64;++n)l[s>>2]|=e[n]<<i[3&s++];else for(s=this.start;n<o&&s<64;++n)(t=e.charCodeAt(n))<128?l[s>>2]|=t<<i[3&s++]:(t<2048?l[s>>2]|=(192|t>>6)<<i[3&s++]:(t<55296||t>=57344?l[s>>2]|=(224|t>>12)<<i[3&s++]:(t=65536+((1023&t)<<10|1023&e.charCodeAt(++n)),l[s>>2]|=(240|t>>18)<<i[3&s++],l[s>>2]|=(128|t>>12&63)<<i[3&s++]),l[s>>2]|=(128|t>>6&63)<<i[3&s++]),l[s>>2]|=(128|63&t)<<i[3&s++]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=l[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},c.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,r=this.lastByteIndex;e[16]=this.block,e[r>>2]|=o[3&r],this.block=e[16],r>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},c.prototype.hash=function(){var e,r,t,s=this.h0,a=this.h1,n=this.h2,o=this.h3,i=this.h4,l=this.blocks;for(r=16;r<80;++r)t=l[r-3]^l[r-8]^l[r-14]^l[r-16],l[r]=t<<1|t>>>31;for(r=0;r<20;r+=5)e=a&n|~a&o,i=(t=s<<5|s>>>27)+e+i+1518500249+l[r]<<0,e=s&(a=a<<30|a>>>2)|~s&n,o=(t=i<<5|i>>>27)+e+o+1518500249+l[r+1]<<0,e=i&(s=s<<30|s>>>2)|~i&a,n=(t=o<<5|o>>>27)+e+n+1518500249+l[r+2]<<0,e=o&(i=i<<30|i>>>2)|~o&s,a=(t=n<<5|n>>>27)+e+a+1518500249+l[r+3]<<0,e=n&(o=o<<30|o>>>2)|~n&i,s=(t=a<<5|a>>>27)+e+s+1518500249+l[r+4]<<0,n=n<<30|n>>>2;for(;r<40;r+=5)e=a^n^o,i=(t=s<<5|s>>>27)+e+i+1859775393+l[r]<<0,e=s^(a=a<<30|a>>>2)^n,o=(t=i<<5|i>>>27)+e+o+1859775393+l[r+1]<<0,e=i^(s=s<<30|s>>>2)^a,n=(t=o<<5|o>>>27)+e+n+1859775393+l[r+2]<<0,e=o^(i=i<<30|i>>>2)^s,a=(t=n<<5|n>>>27)+e+a+1859775393+l[r+3]<<0,e=n^(o=o<<30|o>>>2)^i,s=(t=a<<5|a>>>27)+e+s+1859775393+l[r+4]<<0,n=n<<30|n>>>2;for(;r<60;r+=5)e=a&n|a&o|n&o,i=(t=s<<5|s>>>27)+e+i-1894007588+l[r]<<0,e=s&(a=a<<30|a>>>2)|s&n|a&n,o=(t=i<<5|i>>>27)+e+o-1894007588+l[r+1]<<0,e=i&(s=s<<30|s>>>2)|i&a|s&a,n=(t=o<<5|o>>>27)+e+n-1894007588+l[r+2]<<0,e=o&(i=i<<30|i>>>2)|o&s|i&s,a=(t=n<<5|n>>>27)+e+a-1894007588+l[r+3]<<0,e=n&(o=o<<30|o>>>2)|n&i|o&i,s=(t=a<<5|a>>>27)+e+s-1894007588+l[r+4]<<0,n=n<<30|n>>>2;for(;r<80;r+=5)e=a^n^o,i=(t=s<<5|s>>>27)+e+i-899497514+l[r]<<0,e=s^(a=a<<30|a>>>2)^n,o=(t=i<<5|i>>>27)+e+o-899497514+l[r+1]<<0,e=i^(s=s<<30|s>>>2)^a,n=(t=o<<5|o>>>27)+e+n-899497514+l[r+2]<<0,e=o^(i=i<<30|i>>>2)^s,a=(t=n<<5|n>>>27)+e+a-899497514+l[r+3]<<0,e=n^(o=o<<30|o>>>2)^i,s=(t=a<<5|a>>>27)+e+s-899497514+l[r+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+s<<0,this.h1=this.h1+a<<0,this.h2=this.h2+n<<0,this.h3=this.h3+o<<0,this.h4=this.h4+i<<0},c.prototype.hex=function(){this.finalize();var e=this.h0,r=this.h1,t=this.h2,s=this.h3,a=this.h4;return n[e>>28&15]+n[e>>24&15]+n[e>>20&15]+n[e>>16&15]+n[e>>12&15]+n[e>>8&15]+n[e>>4&15]+n[15&e]+n[r>>28&15]+n[r>>24&15]+n[r>>20&15]+n[r>>16&15]+n[r>>12&15]+n[r>>8&15]+n[r>>4&15]+n[15&r]+n[t>>28&15]+n[t>>24&15]+n[t>>20&15]+n[t>>16&15]+n[t>>12&15]+n[t>>8&15]+n[t>>4&15]+n[15&t]+n[s>>28&15]+n[s>>24&15]+n[s>>20&15]+n[s>>16&15]+n[s>>12&15]+n[s>>8&15]+n[s>>4&15]+n[15&s]+n[a>>28&15]+n[a>>24&15]+n[a>>20&15]+n[a>>16&15]+n[a>>12&15]+n[a>>8&15]+n[a>>4&15]+n[15&a]},c.prototype.toString=c.prototype.hex,c.prototype.digest=function(){this.finalize();var e=this.h0,r=this.h1,t=this.h2,s=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,s>>24&255,s>>16&255,s>>8&255,255&s,a>>24&255,a>>16&255,a>>8&255,255&a]},c.prototype.array=c.prototype.digest,c.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),r=new DataView(e);return r.setUint32(0,this.h0),r.setUint32(4,this.h1),r.setUint32(8,this.h2),r.setUint32(12,this.h3),r.setUint32(16,this.h4),e};let u=e=>new c(!0).update(e).hex()},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"50XG0":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("@langchain/core/callbacks/manager");s.exportAll(a,t)},{"@langchain/core/callbacks/manager":"6poIH","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"6poIH":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("../dist/callbacks/manager.js");s.exportAll(a,t)},{"../dist/callbacks/manager.js":"ir00Y","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],lXz6C:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BaseLangChain",()=>a.BaseLangChain),s.export(t,"BaseLanguageModel",()=>a.BaseLanguageModel),s.export(t,"calculateMaxTokens",()=>n.calculateMaxTokens),s.export(t,"getModelContextSize",()=>n.getModelContextSize);var a=e("@langchain/core/language_models/base"),n=e("./count_tokens.js")},{"@langchain/core/language_models/base":"apUX6","./count_tokens.js":"lz5Tq","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],apUX6:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("../dist/language_models/base.js");s.exportAll(a,t)},{"../dist/language_models/base.js":"61too","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"61too":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"getModelNameForTiktoken",()=>u),s.export(t,"getEmbeddingContextSize",()=>p),s.export(t,"getModelContextSize",()=>d),s.export(t,"calculateMaxTokens",()=>h),s.export(t,"BaseLangChain",()=>m),s.export(t,"BaseLanguageModel",()=>b);var a=e("../caches.js"),n=e("../prompt_values.js"),o=e("../messages/index.js"),i=e("../utils/async_caller.js"),l=e("../utils/tiktoken.js"),c=e("../runnables/base.js");let u=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e,p=e=>"text-embedding-ada-002"===e?8191:2046,d=e=>{switch(u(e)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":default:return 4097;case"text-curie-001":case"text-babbage-001":case"text-ada-001":case"code-cushman-001":return 2048;case"code-davinci-002":return 8e3}},h=async({prompt:e,modelName:r})=>{let t;try{t=(await (0,l.encodingForModel)(u(r))).encode(e).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count"),t=Math.ceil(e.length/4)}return d(r)-t},f=()=>!1;class m extends c.Runnable{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??f(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class b extends m{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:r,...t}){super({callbacks:e??r,...t}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"object"==typeof t.cache?this.cache=t.cache:t.cache?this.cache=(0,a.InMemoryCache).global():this.cache=void 0,this.caller=new i.AsyncCaller(t??{})}async getNumTokens(e){if("string"!=typeof e)return 0;let r=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await (0,l.encodingForModel)("modelName"in this?u(this.modelName):"gpt2")}catch(e){console.warn("Failed to calculate number of tokens, falling back to approximate count",e)}if(this._encoding)try{r=this._encoding.encode(e).length}catch(e){console.warn("Failed to calculate number of tokens, falling back to approximate count",e)}return r}static _convertInputToPromptValue(e){return"string"==typeof e?new n.StringPromptValue(e):Array.isArray(e)?new n.ChatPromptValue(e.map(o.coerceMessageLikeToMessage)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall(e){return Object.entries({...this._identifyingParams(),...e,_type:this._llmType(),_model:this._modelType()}).filter(([e,r])=>void 0!==r).map(([e,r])=>`${e}:${JSON.stringify(r)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw Error("Use .toJSON() instead")}}},{"../caches.js":"ei2vN","../prompt_values.js":"bLGqd","../messages/index.js":"3Jjkr","../utils/async_caller.js":"7n77o","../utils/tiktoken.js":"hAN9N","../runnables/base.js":"aHxsd","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],hAN9N:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"getEncoding",()=>l),s.export(t,"encodingForModel",()=>c);var a=e("js-tiktoken/lite"),n=e("./async_caller.js");let o={},i=new n.AsyncCaller({});async function l(e){return e in o||(o[e]=i.fetch(`https://tiktoken.pages.dev/js/${e}.json`).then(e=>e.json()).then(e=>new a.Tiktoken(e)).catch(r=>{throw delete o[e],r})),await o[e]}async function c(e){return l((0,a.getEncodingNameForModel)(e))}},{"js-tiktoken/lite":"gwSDl","./async_caller.js":"7n77o","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],gwSDl:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"Tiktoken",()=>a.Tiktoken),s.export(t,"getEncodingNameForModel",()=>a.getEncodingNameForModel);var a=e("./chunk-YVJR5WRT.js")},{"./chunk-YVJR5WRT.js":"dDFmy","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],dDFmy:[function(e,r,t){let s,a;var n,o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(t),o.export(t,"Tiktoken",()=>d),o.export(t,"getEncodingNameForModel",()=>h),o.export(t,"never",()=>u);var i=e("base64-js"),l=o.interopDefault(i),c=Object.defineProperty;function u(e){}var p=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=new TextEncoder;textDecoder=new TextDecoder("utf-8");rankMap=new Map;textMap=new Map;constructor(e,r){for(let[r,t]of(this.patStr=e.pat_str,Object.entries(e.bpe_ranks.split("\n").filter(Boolean).reduce((e,r)=>{let[t,s,...a]=r.split(" "),n=Number.parseInt(s,10);return a.forEach((r,t)=>e[r]=n+t),e},{})))){let e=(0,l.default).toByteArray(r);this.rankMap.set(e.join(","),t),this.textMap.set(t,e)}this.specialTokens={...e.special_tokens,...r},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((e,[r,t])=>(e[t]=this.textEncoder.encode(r),e),{})}encode(e,r=[],t="all"){let s=RegExp(this.patStr,"ug"),a=p.specialTokenRegex(Object.keys(this.specialTokens)),n=[],o=new Set("all"===r?Object.keys(this.specialTokens):r),i=new Set("all"===t?Object.keys(this.specialTokens).filter(e=>!o.has(e)):t);if(i.size>0){let r=p.specialTokenRegex([...i]),t=e.match(r);if(null!=t)throw Error(`The text contains a special token that is not allowed: ${t[0]}`)}let l=0;for(;;){let r=null,t=l;for(;a.lastIndex=t,!(null==(r=a.exec(e))||o.has(r[0]));)t=r.index+1;let i=r?.index??e.length;for(let r of e.substring(l,i).matchAll(s)){let e=this.textEncoder.encode(r[0]),t=this.rankMap.get(e.join(","));if(null!=t){n.push(t);continue}n.push(...function(e,r){return 1===e.length?[r.get(e.join(","))]:(function(e,r){let t=Array.from({length:e.length},(e,r)=>({start:r,end:r+1}));for(;t.length>1;){let s=null;for(let a=0;a<t.length-1;a++){let n=e.slice(t[a].start,t[a+1].end),o=r.get(n.join(","));null!=o&&(null==s||o<s[0])&&(s=[o,a])}if(null!=s){let e=s[1];t[e]={start:t[e].start,end:t[e+1].end},t.splice(e+1,1)}else break}return t})(e,r).map(t=>r.get(e.slice(t.start,t.end).join(","))).filter(e=>null!=e)}(e,this.rankMap))}if(null==r)break;let c=this.specialTokens[r[0]];n.push(c),l=r.index+r[0].length}return n}decode(e){let r=[],t=0;for(let s=0;s<e.length;++s){let a=e[s],n=this.textMap.get(a)??this.inverseSpecialTokens[a];null!=n&&(r.push(n),t+=n.length)}let s=new Uint8Array(t),a=0;for(let e of r)s.set(e,a),a+=e.length;return this.textDecoder.decode(s)}},d=p;function h(e){switch(e){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw Error("Unknown model")}}s="symbol"!=typeof(n="specialTokenRegex")?n+"":n,a=e=>RegExp(e.map(e=>e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")).join("|"),"g"),s in d?c(d,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[s]=a},{"base64-js":"1ZV1g","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"1ZV1g":[function(e,r,t){t.byteLength=function(e){var r=c(e),t=r[0],s=r[1];return(t+s)*3/4-s},t.toByteArray=function(e){var r,t,s=c(e),o=s[0],i=s[1],l=new n((o+i)*3/4-i),u=0,p=i>0?o-4:o;for(t=0;t<p;t+=4)r=a[e.charCodeAt(t)]<<18|a[e.charCodeAt(t+1)]<<12|a[e.charCodeAt(t+2)]<<6|a[e.charCodeAt(t+3)],l[u++]=r>>16&255,l[u++]=r>>8&255,l[u++]=255&r;return 2===i&&(r=a[e.charCodeAt(t)]<<2|a[e.charCodeAt(t+1)]>>4,l[u++]=255&r),1===i&&(r=a[e.charCodeAt(t)]<<10|a[e.charCodeAt(t+1)]<<4|a[e.charCodeAt(t+2)]>>2,l[u++]=r>>8&255,l[u++]=255&r),l},t.fromByteArray=function(e){for(var r,t=e.length,a=t%3,n=[],o=0,i=t-a;o<i;o+=16383)n.push(function(e,r,t){for(var a,n=[],o=r;o<t;o+=3)n.push(s[(a=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+s[a>>12&63]+s[a>>6&63]+s[63&a]);return n.join("")}(e,o,o+16383>i?i:o+16383));return 1===a?n.push(s[(r=e[t-1])>>2]+s[r<<4&63]+"=="):2===a&&n.push(s[(r=(e[t-2]<<8)+e[t-1])>>10]+s[r>>4&63]+s[r<<2&63]+"="),n.join("")};for(var s=[],a=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,l=o.length;i<l;++i)s[i]=o[i],a[o.charCodeAt(i)]=i;function c(e){var r=e.length;if(r%4>0)throw Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");-1===t&&(t=r);var s=t===r?0:4-t%4;return[t,s]}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},{}],lz5Tq:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"calculateMaxTokens",()=>a.calculateMaxTokens),s.export(t,"getModelContextSize",()=>a.getModelContextSize),s.export(t,"getEmbeddingContextSize",()=>a.getEmbeddingContextSize);var a=e("@langchain/core/language_models/base")},{"@langchain/core/language_models/base":"apUX6","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],lJbk3:[function(e,r,t){r.exports=Promise.all([e("bb2cbfd214270014")(e("703dd54c42f59471").getBundleURL("lmlKL")+e("9f5a5ec5fccf74ac").resolve("ceGYv")),e("bb2cbfd214270014")(e("703dd54c42f59471").getBundleURL("lmlKL")+e("9f5a5ec5fccf74ac").resolve("lBkr1")),e("bb2cbfd214270014")(e("703dd54c42f59471").getBundleURL("lmlKL")+e("9f5a5ec5fccf74ac").resolve("lmlKL"))]).then(()=>r.bundle.root("dLYP0"))},{bb2cbfd214270014:"bVEmA","703dd54c42f59471":"1mwjW","9f5a5ec5fccf74ac":"3OylR"}],bVEmA:[function(e,r,t){var s=e("ca2a84f7fa4a3bb0");r.exports=s(function(e){return new Promise(function(r,t){if([].concat(document.getElementsByTagName("script")).some(function(r){return r.src===e})){r();return}var s=document.createElement("link");s.href=e,s.rel="preload",s.as="script",document.head.appendChild(s);var a=document.createElement("script");a.async=!0,a.type="text/javascript",a.src=e,a.onerror=function(r){var s=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(r.message));a.onerror=a.onload=null,a.remove(),t(s)},a.onload=function(){a.onerror=a.onload=null,r()},document.getElementsByTagName("head")[0].appendChild(a)})})},{ca2a84f7fa4a3bb0:"25l13"}],"25l13":[function(e,r,t){var s={},a={},n={};r.exports=function(e,r){return function(t){var o=function(e){switch(e){case"preload":return a;case"prefetch":return n;default:return s}}(r);return o[t]?o[t]:o[t]=e.apply(null,arguments).catch(function(e){throw delete o[t],e})}}},{}],"1mwjW":[function(e,r,t){var s={};function a(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}t.getBundleURL=function(e){var r=s[e];return r||(r=function(){try{throw Error()}catch(r){var e=(""+r.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return a(e[2])}return"/"}(),s[e]=r),r},t.getBaseURL=a,t.getOrigin=function(e){var r=(""+e).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!r)throw Error("Origin not found");return r[0]}},{}],fZFYW:[function(e,r,t){r.exports=e("9957ee8a47f5c5a8")(e("32fdc47451cbcd63").getBundleURL("lmlKL")+e("3b5299ed9dcd85e2").resolve("luRQj")).then(()=>r.bundle.root("2zMii"))},{"9957ee8a47f5c5a8":"bVEmA","32fdc47451cbcd63":"1mwjW","3b5299ed9dcd85e2":"3OylR"}],eneXk:[function(e,r,t){r.exports=Promise.all([e("cfb417b7655b7ad6")(e("83a623a3739df654").getBundleURL("lmlKL")+e("19ffdf6d96e35a49").resolve("lmlKL")),e("cfb417b7655b7ad6")(e("83a623a3739df654").getBundleURL("lmlKL")+e("19ffdf6d96e35a49").resolve("ceGYv")),e("cfb417b7655b7ad6")(e("83a623a3739df654").getBundleURL("lmlKL")+e("19ffdf6d96e35a49").resolve("lBkr1")),e("cfb417b7655b7ad6")(e("83a623a3739df654").getBundleURL("lmlKL")+e("19ffdf6d96e35a49").resolve("3qIni"))]).then(()=>r.bundle.root("dfXNh"))},{cfb417b7655b7ad6:"bVEmA","83a623a3739df654":"1mwjW","19ffdf6d96e35a49":"3OylR"}],d09x5:[function(e,r,t){r.exports=Promise.all([e("fdb08ffdba984426")(e("b7198a8cc1700a20").getBundleURL("lmlKL")+e("348c41f8b8d3f16").resolve("lmlKL")),e("fdb08ffdba984426")(e("b7198a8cc1700a20").getBundleURL("lmlKL")+e("348c41f8b8d3f16").resolve("3qIni")),e("fdb08ffdba984426")(e("b7198a8cc1700a20").getBundleURL("lmlKL")+e("348c41f8b8d3f16").resolve("ceGYv")),e("fdb08ffdba984426")(e("b7198a8cc1700a20").getBundleURL("lmlKL")+e("348c41f8b8d3f16").resolve("lBkr1")),e("fdb08ffdba984426")(e("b7198a8cc1700a20").getBundleURL("lmlKL")+e("348c41f8b8d3f16").resolve("goC8E"))]).then(()=>r.bundle.root("tOuqw"))},{fdb08ffdba984426:"bVEmA",b7198a8cc1700a20:"1mwjW","348c41f8b8d3f16":"3OylR"}],ePxvh:[function(e,r,t){r.exports=Promise.all([e("4c352a47843107d4")(e("f33fa72034cca109").getBundleURL("lmlKL")+e("56405411a3d3995f").resolve("lmlKL")),e("4c352a47843107d4")(e("f33fa72034cca109").getBundleURL("lmlKL")+e("56405411a3d3995f").resolve("ceGYv")),e("4c352a47843107d4")(e("f33fa72034cca109").getBundleURL("lmlKL")+e("56405411a3d3995f").resolve("lBkr1")),e("4c352a47843107d4")(e("f33fa72034cca109").getBundleURL("lmlKL")+e("56405411a3d3995f").resolve("jXHDk"))]).then(()=>r.bundle.root("eamzE"))},{"4c352a47843107d4":"bVEmA",f33fa72034cca109:"1mwjW","56405411a3d3995f":"3OylR"}],"8VjQL":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BaseStringPromptTemplate",()=>a.BaseStringPromptTemplate),s.export(t,"BasePromptTemplate",()=>a.BasePromptTemplate),s.export(t,"StringPromptValue",()=>n.StringPromptValue),s.export(t,"BaseExampleSelector",()=>o.BaseExampleSelector);var a=e("@langchain/core/prompts"),n=e("@langchain/core/prompt_values"),o=e("@langchain/core/example_selectors")},{"@langchain/core/prompts":"jpJY6","@langchain/core/prompt_values":"fyYr2","@langchain/core/example_selectors":"8Lzus","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],jpJY6:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/prompts/index.js");s.exportAll(a,t)},{"./dist/prompts/index.js":"liyXO","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],liyXO:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./base.js");s.exportAll(a,t);var n=e("./chat.js");s.exportAll(n,t);var o=e("./few_shot.js");s.exportAll(o,t);var i=e("./pipeline.js");s.exportAll(i,t);var l=e("./prompt.js");s.exportAll(l,t);var c=e("./serde.js");s.exportAll(c,t);var u=e("./string.js");s.exportAll(u,t);var p=e("./template.js");s.exportAll(p,t)},{"./base.js":"2t6r4","./chat.js":"jaqMR","./few_shot.js":"99kNl","./pipeline.js":"hFPTF","./prompt.js":"44sow","./serde.js":"1ujrv","./string.js":"aqpn1","./template.js":"1eKek","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],hFPTF:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"PipelinePromptTemplate",()=>o);var a=e("./base.js"),n=e("./chat.js");class o extends a.BasePromptTemplate{static lc_name(){return"PipelinePromptTemplate"}constructor(e){super({...e,inputVariables:[]}),Object.defineProperty(this,"pipelinePrompts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finalPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pipelinePrompts=e.pipelinePrompts,this.finalPrompt=e.finalPrompt,this.inputVariables=this.computeInputValues()}computeInputValues(){let e=this.pipelinePrompts.map(e=>e.name);return[...new Set(this.pipelinePrompts.map(r=>r.prompt.inputVariables.filter(r=>!e.includes(r))).flat())]}static extractRequiredInputValues(e,r){return r.reduce((r,t)=>(r[t]=e[t],r),{})}async formatPipelinePrompts(e){let r=await this.mergePartialAndUserVariables(e);for(let{name:e,prompt:t}of this.pipelinePrompts){let s=o.extractRequiredInputValues(r,t.inputVariables);t instanceof n.ChatPromptTemplate?r[e]=await t.formatMessages(s):r[e]=await t.format(s)}return o.extractRequiredInputValues(r,this.finalPrompt.inputVariables)}async formatPromptValue(e){return this.finalPrompt.formatPromptValue(await this.formatPipelinePrompts(e))}async format(e){return this.finalPrompt.format(await this.formatPipelinePrompts(e))}async partial(e){let r={...this};return r.inputVariables=this.inputVariables.filter(r=>!(r in e)),r.partialVariables={...this.partialVariables??{},...e},new o(r)}serialize(){throw Error("Not implemented.")}_getPromptType(){return"pipeline"}}},{"./base.js":"2t6r4","./chat.js":"jaqMR","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"1ujrv":[function(e,r,t){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"8Lzus":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/example_selectors/index.js");s.exportAll(a,t)},{"./dist/example_selectors/index.js":"1dZfM","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"1dZfM":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./base.js");s.exportAll(a,t);var n=e("./conditional.js");s.exportAll(n,t);var o=e("./length_based.js");s.exportAll(o,t);var i=e("./semantic_similarity.js");s.exportAll(i,t)},{"./base.js":"luye0","./conditional.js":"cQWXH","./length_based.js":"3BNAd","./semantic_similarity.js":"fNVuQ","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],luye0:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BaseExampleSelector",()=>n);var a=e("../load/serializable.js");class n extends a.Serializable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","example_selectors","base"]})}}},{"../load/serializable.js":"MmHAq","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],cQWXH:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BasePromptSelector",()=>a),s.export(t,"ConditionalPromptSelector",()=>n),s.export(t,"isLLM",()=>o),s.export(t,"isChatModel",()=>i);class a{async getPromptAsync(e,r){return this.getPrompt(e).partial(r?.partialVariables??{})}}class n extends a{constructor(e,r=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=r}getPrompt(e){for(let[r,t]of this.conditionals)if(r(e))return t;return this.defaultPrompt}}function o(e){return"base_llm"===e._modelType()}function i(e){return"base_chat_model"===e._modelType()}},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"3BNAd":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"LengthBasedExampleSelector",()=>o);var a=e("./base.js");function n(e){return e.split(/\n| /).length}class o extends a.BaseExampleSelector{constructor(e){super(e),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getTextLength",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,writable:!0,value:2048}),Object.defineProperty(this,"exampleTextLengths",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.examplePrompt=e.examplePrompt,this.maxLength=e.maxLength??2048,this.getTextLength=e.getTextLength??n}async addExample(e){this.examples.push(e);let r=await this.examplePrompt.format(e);this.exampleTextLengths.push(this.getTextLength(r))}async calculateExampleTextLengths(e,r){if(e.length>0)return e;let{examples:t,examplePrompt:s}=r;return(await Promise.all(t.map(e=>s.format(e)))).map(e=>this.getTextLength(e))}async selectExamples(e){let r=Object.values(e).join(" "),t=this.maxLength-this.getTextLength(r),s=0,a=[];for(;t>0&&s<this.examples.length;){let e=t-this.exampleTextLengths[s];if(e<0)break;a.push(this.examples[s]),t=e,s+=1}return a}static async fromExamples(e,r){let t=new o(r);return await Promise.all(e.map(e=>t.addExample(e))),t}}},{"./base.js":"luye0","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],fNVuQ:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"SemanticSimilarityExampleSelector",()=>i);var a=e("../documents/document.js"),n=e("./base.js");function o(e){return Object.keys(e).sort().map(r=>e[r])}class i extends n.BaseExampleSelector{constructor(e){if(super(e),Object.defineProperty(this,"vectorStoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.exampleKeys=e.exampleKeys,this.inputKeys=e.inputKeys,void 0!==e.vectorStore)this.vectorStoreRetriever=e.vectorStore.asRetriever({k:e.k??4,filter:e.filter});else if(e.vectorStoreRetriever)this.vectorStoreRetriever=e.vectorStoreRetriever;else throw Error('You must specify one of "vectorStore" and "vectorStoreRetriever".')}async addExample(e){let r=o((this.inputKeys??Object.keys(e)).reduce((r,t)=>({...r,[t]:e[t]}),{})).join(" ");await this.vectorStoreRetriever.addDocuments([new a.Document({pageContent:r,metadata:e})])}async selectExamples(e){let r=o((this.inputKeys??Object.keys(e)).reduce((r,t)=>({...r,[t]:e[t]}),{})).join(" "),t=(await this.vectorStoreRetriever.invoke(r)).map(e=>e.metadata);return this.exampleKeys?t.map(e=>this.exampleKeys.reduce((r,t)=>({...r,[t]:e[t]}),{})):t}static async fromExamples(e,r,t,s={}){let a=s.inputKeys??null,n=e.map(e=>o(a?a.reduce((r,t)=>({...r,[t]:e[t]}),{}):e).join(" "));return new i({vectorStore:await t.fromTexts(n,e,r,s),k:s.k??4,exampleKeys:s.exampleKeys,inputKeys:s.inputKeys})}}},{"../documents/document.js":"hUrHs","./base.js":"luye0","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],hUrHs:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"Document",()=>a);class a{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent?e.pageContent.toString():this.pageContent,this.metadata=e.metadata??{}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],eQKjp:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"NoOpOutputParser",()=>n);var a=e("../schema/output_parser.js");class n extends a.BaseOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"NoOpOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}},{"../schema/output_parser.js":"eZzBK","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],eZzBK:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("@langchain/core/output_parsers");s.exportAll(a,t)},{"@langchain/core/output_parsers":"kQAi2","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],kQAi2:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/output_parsers/index.js");s.exportAll(a,t)},{"./dist/output_parsers/index.js":"9HOeI","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"9HOeI":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./base.js");s.exportAll(a,t);var n=e("./bytes.js");s.exportAll(n,t);var o=e("./list.js");s.exportAll(o,t);var i=e("./string.js");s.exportAll(i,t);var l=e("./transform.js");s.exportAll(l,t)},{"./base.js":"9VMS6","./bytes.js":"8oDo1","./list.js":"ehZyh","./string.js":"13QXV","./transform.js":"4T2ok","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"9VMS6":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BaseLLMOutputParser",()=>n),s.export(t,"BaseOutputParser",()=>o),s.export(t,"OutputParserException",()=>i);var a=e("../runnables/index.js");class n extends a.Runnable{parseResultWithPrompt(e,r,t){return this.parseResult(e,t)}async invoke(e,r){return"string"==typeof e?this._callWithConfig(async e=>this.parseResult([{text:e}]),e,{...r,runType:"parser"}):this._callWithConfig(async e=>this.parseResult([{message:e,text:"string"==typeof e.content?e.content:JSON.stringify(e.content)}]),e,{...r,runType:"parser"})}}class o extends n{parseResult(e,r){return this.parse(e[0].text,r)}async parseWithPrompt(e,r,t){return this.parse(e,t)}_type(){throw Error("_type not implemented")}}class i extends Error{constructor(e,r,t,s=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=r,this.observation=t,this.sendToLLM=s,s&&(void 0===t||void 0===r))throw Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}},{"../runnables/index.js":"8Mv1g","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"8Mv1g":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"Runnable",()=>a.Runnable),s.export(t,"RunnableBinding",()=>a.RunnableBinding),s.export(t,"RunnableEach",()=>a.RunnableEach),s.export(t,"RunnableRetry",()=>a.RunnableRetry),s.export(t,"RunnableSequence",()=>a.RunnableSequence),s.export(t,"RunnableMap",()=>a.RunnableMap),s.export(t,"RunnableParallel",()=>a.RunnableParallel),s.export(t,"RunnableLambda",()=>a.RunnableLambda),s.export(t,"RunnableWithFallbacks",()=>a.RunnableWithFallbacks),s.export(t,"_coerceToRunnable",()=>a._coerceToRunnable),s.export(t,"RunnablePassthrough",()=>n.RunnablePassthrough),s.export(t,"RunnableAssign",()=>n.RunnableAssign),s.export(t,"RouterRunnable",()=>o.RouterRunnable),s.export(t,"RunnableBranch",()=>i.RunnableBranch),s.export(t,"RunnableWithMessageHistory",()=>l.RunnableWithMessageHistory);var a=e("./base.js"),n=e("./passthrough.js"),o=e("./router.js"),i=e("./branch.js"),l=e("./history.js")},{"./base.js":"aHxsd","./passthrough.js":"jPFH1","./router.js":"gCPSj","./branch.js":"bl1CG","./history.js":"gyeqM","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],jPFH1:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"RunnableAssign",()=>n),s.export(t,"RunnablePassthrough",()=>o);var a=e("./base.js");class n extends a.Runnable{constructor(e){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e}async invoke(e,r){let t=await this.mapper.invoke(e,r);return{...e,...t}}}class o extends a.Runnable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"RunnablePassthrough"}async invoke(e,r){return this._callWithConfig(e=>Promise.resolve(e),e,r)}static assign(e){return new n(new a.RunnableMap({steps:e}))}}},{"./base.js":"aHxsd","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],gCPSj:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"RouterRunnable",()=>n);var a=e("./base.js");class n extends a.Runnable{static lc_name(){return"RouterRunnable"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnables=e.runnables}async invoke(e,r){let{key:t,input:s}=e,a=this.runnables[t];if(void 0===a)throw Error(`No runnable associated with key "${t}".`);return a.invoke(s,r)}async batch(e,r,t){let s=e.map(e=>e.key),a=e.map(e=>e.input);if(void 0!==s.find(e=>void 0===this.runnables[e]))throw Error("One or more keys do not have a corresponding runnable.");let n=s.map(e=>this.runnables[e]),o=this._getOptionsList(r??{},e.length),i=t?.maxConcurrency&&t.maxConcurrency>0?t?.maxConcurrency:e.length,l=[];for(let e=0;e<a.length;e+=i){let r=a.slice(e,e+i).map((e,r)=>n[r].invoke(e,o[r])),t=await Promise.all(r);l.push(t)}return l.flat()}async stream(e,r){let{key:t,input:s}=e,a=this.runnables[t];if(void 0===a)throw Error(`No runnable associated with key "${t}".`);return a.stream(s,r)}}},{"./base.js":"aHxsd","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],bl1CG:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"RunnableBranch",()=>n);var a=e("./base.js");class n extends a.Runnable{static lc_name(){return"RunnableBranch"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"default",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"branches",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.branches=e.branches,this.default=e.default}static from(e){if(e.length<1)throw Error("RunnableBranch requires at least one branch");return new this({branches:e.slice(0,-1).map(([e,r])=>[(0,a._coerceToRunnable)(e),(0,a._coerceToRunnable)(r)]),default:(0,a._coerceToRunnable)(e[e.length-1])})}async _invoke(e,r,t){let s;for(let a=0;a<this.branches.length;a+=1){let[n,o]=this.branches[a];if(await n.invoke(e,this._patchConfig(r,t?.getChild(`condition:${a+1}`)))){s=await o.invoke(e,this._patchConfig(r,t?.getChild(`branch:${a+1}`)));break}}return s||(s=await this.default.invoke(e,this._patchConfig(r,t?.getChild("default")))),s}async invoke(e,r={}){return this._callWithConfig(this._invoke,e,r)}}},{"./base.js":"aHxsd","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],gyeqM:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"RunnableWithMessageHistory",()=>i);var a=e("../messages/index.js"),n=e("./base.js"),o=e("./passthrough.js");class i extends n.RunnableBinding{constructor(e){let r=new(0,n.RunnableLambda)({func:(e,r)=>this._enterHistory(e,r??{})}).withConfig({runName:"loadHistory"}),t=e.historyMessagesKey??e.inputMessagesKey;t&&(r=(0,o.RunnablePassthrough).assign({[t]:r}).withConfig({runName:"insertHistory"})),super({...e,config:e.config??{},bound:r.pipe(e.runnable.withListeners({onEnd:(e,r)=>this._exitHistory(e,r??{})})).withConfig({runName:"RunnableWithMessageHistory"})}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"historyMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getMessageHistory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.getMessageHistory=e.getMessageHistory,this.inputMessagesKey=e.inputMessagesKey,this.outputMessagesKey=e.outputMessagesKey,this.historyMessagesKey=e.historyMessagesKey}_getInputMessages(e){return"string"==typeof e?[new a.HumanMessage(e)]:Array.isArray(e)?e:[e]}_getOutputMessages(e){let r=e;if(Array.isArray(e)||(0,a.isBaseMessage)(e)||"string"==typeof e||(r=e[this.outputMessagesKey??"output"]),"string"==typeof r)return[new a.AIMessage(r)];if(Array.isArray(r))return r;if((0,a.isBaseMessage)(r))return[r];throw Error(`Expected a string, BaseMessage, or array of BaseMessages. Received: ${JSON.stringify(r,null,2)}`)}_enterHistory(e,r){let t=r?.config?.configurable?.messageHistory;if(this.historyMessagesKey)return t.messages;let s=e||(this.inputMessagesKey?e[this.inputMessagesKey]:void 0);return[...t?t.messages:[],...this._getInputMessages(s)]}async _exitHistory(e,r){let t=r.configurable?.messageHistory,{inputs:s}=e,a=s[this.inputMessagesKey??"input"],n=this._getInputMessages(a),o=e.outputs;if(!o)throw Error(`Output values from 'Run' undefined. Run: ${JSON.stringify(e,null,2)}`);for await(let e of[...n,...this._getOutputMessages(o)])await t.addMessage(e)}async _mergeConfig(...e){let r=await super._mergeConfig(...e);if(!r.configurable||!r.configurable.sessionId){let e={[this.inputMessagesKey??"input"]:"foo"};throw Error(`sessionId is required. Pass it in as part of the config argument to .invoke() or .stream()
eg. chain.invoke(${JSON.stringify(e)}, ${JSON.stringify({configurable:{sessionId:"123"}})})`)}let{sessionId:t}=r.configurable;return r.configurable.messageHistory=await this.getMessageHistory(t),r}}},{"../messages/index.js":"3Jjkr","./base.js":"aHxsd","./passthrough.js":"jPFH1","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"8oDo1":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BytesOutputParser",()=>n);var a=e("./transform.js");class n extends a.BaseTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","bytes"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"textEncoder",{enumerable:!0,configurable:!0,writable:!0,value:new TextEncoder})}static lc_name(){return"BytesOutputParser"}parse(e){return Promise.resolve(this.textEncoder.encode(e))}getFormatInstructions(){return""}}},{"./transform.js":"4T2ok","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"4T2ok":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"BaseTransformOutputParser",()=>l),s.export(t,"BaseCumulativeTransformOutputParser",()=>c);var a=e("./base.js"),n=e("../messages/index.js"),o=e("../outputs.js"),i=e("../utils/@cfworker/json-schema/index.js");class l extends a.BaseOutputParser{async *_transform(e){for await(let r of e)"string"==typeof r?yield this.parseResult([{text:r}]):yield this.parseResult([{message:r,text:"string"==typeof r.content?r.content:JSON.stringify(r.content)}])}async *transform(e,r){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...r,runType:"parser"})}}class c extends l{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=e?.diff??this.diff}async *_transform(e){let r,t;for await(let s of e){let e;if("string"!=typeof s&&"string"!=typeof s.content)throw Error("Cannot handle non-string output.");if((0,n.isBaseMessageChunk)(s)){if("string"!=typeof s.content)throw Error("Cannot handle non-string message output.");e=new o.ChatGenerationChunk({message:s,text:s.content})}else if((0,n.isBaseMessage)(s)){if("string"!=typeof s.content)throw Error("Cannot handle non-string message output.");e=new o.ChatGenerationChunk({message:s.toChunk(),text:s.content})}else e=new o.GenerationChunk({text:s});t=void 0===t?e:t.concat(e);let a=await this.parsePartialResult([t]);null==a||(0,i.deepCompareStrict)(a,r)||(this.diff?yield this._diff(r,a):yield a,r=a)}}}},{"./base.js":"9VMS6","../messages/index.js":"3Jjkr","../outputs.js":"cXWxZ","../utils/@cfworker/json-schema/index.js":"aJgoC","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],aJgoC:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./src/index.js");s.exportAll(a,t)},{"./src/index.js":"lPY7h","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],lPY7h:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./deep-compare-strict.js");s.exportAll(a,t);var n=e("./dereference.js");s.exportAll(n,t);var o=e("./format.js");s.exportAll(o,t);var i=e("./pointer.js");s.exportAll(i,t);var l=e("./types.js");s.exportAll(l,t);var c=e("./ucs2-length.js");s.exportAll(c,t);var u=e("./validate.js");s.exportAll(u,t);var p=e("./validator.js");s.exportAll(p,t)},{"./deep-compare-strict.js":"fujar","./dereference.js":"kPeMG","./format.js":"3PtHK","./pointer.js":"aDeec","./types.js":"2K2FR","./ucs2-length.js":"4eer2","./validate.js":"fLAEA","./validator.js":"iFljz","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],fujar:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"deepCompareStrict",()=>function e(r,t){let s=typeof r;if(s!==typeof t)return!1;if(Array.isArray(r)){if(!Array.isArray(t))return!1;let s=r.length;if(s!==t.length)return!1;for(let a=0;a<s;a++)if(!e(r[a],t[a]))return!1;return!0}if("object"===s){if(!r||!t)return r===t;let s=Object.keys(r),a=Object.keys(t);if(s.length!==a.length)return!1;for(let a of s)if(!e(r[a],t[a]))return!1;return!0}return r===t})},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],kPeMG:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"schemaKeyword",()=>n),s.export(t,"schemaArrayKeyword",()=>o),s.export(t,"schemaMapKeyword",()=>i),s.export(t,"ignoredKeyword",()=>l),s.export(t,"initialBaseURI",()=>c),s.export(t,"dereference",()=>function e(r,t=Object.create(null),s=c,n=""){if(r&&"object"==typeof r&&!Array.isArray(r)){let a=r.$id||r.id;if(a){let o=new URL(a,s.href);o.hash.length>1?t[o.href]=r:(o.hash="",""===n?s=o:e(r,t,s))}}else if(!0!==r&&!1!==r)return t;let u=s.href+(n?"#"+n:"");if(void 0!==t[u])throw Error(`Duplicate schema URI "${u}".`);if(t[u]=r,!0===r||!1===r)return t;if(void 0===r.__absolute_uri__&&Object.defineProperty(r,"__absolute_uri__",{enumerable:!1,value:u}),r.$ref&&void 0===r.__absolute_ref__){let e=new URL(r.$ref,s.href);e.hash=e.hash,Object.defineProperty(r,"__absolute_ref__",{enumerable:!1,value:e.href})}if(r.$recursiveRef&&void 0===r.__absolute_recursive_ref__){let e=new URL(r.$recursiveRef,s.href);e.hash=e.hash,Object.defineProperty(r,"__absolute_recursive_ref__",{enumerable:!1,value:e.href})}for(let c in r.$anchor&&(t[new URL("#"+r.$anchor,s.href).href]=r),r){if(l[c])continue;let u=`${n}/${(0,a.encodePointer)(c)}`,p=r[c];if(Array.isArray(p)){if(o[c]){let r=p.length;for(let a=0;a<r;a++)e(p[a],t,s,`${u}/${a}`)}}else if(i[c])for(let r in p)e(p[r],t,s,`${u}/${(0,a.encodePointer)(r)}`);else e(p,t,s,u)}return t});var a=e("./pointer.js");let n={additionalItems:!0,unevaluatedItems:!0,items:!0,contains:!0,additionalProperties:!0,unevaluatedProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},o={prefixItems:!0,items:!0,allOf:!0,anyOf:!0,oneOf:!0},i={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependentSchemas:!0},l={id:!0,$id:!0,$ref:!0,$schema:!0,$anchor:!0,$vocabulary:!0,$comment:!0,default:!0,enum:!0,const:!0,required:!0,type:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0},c="undefined"!=typeof self&&self.location?new URL(self.location.origin+self.location.pathname+location.search):new URL("https://github.com/cfworker")},{"./pointer.js":"aDeec","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],aDeec:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");function a(e){return encodeURI(n(e))}function n(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}s.defineInteropFlag(t),s.export(t,"encodePointer",()=>a),s.export(t,"escapePointer",()=>n)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"3PtHK":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"fullFormat",()=>l),s.export(t,"fastFormat",()=>c);let a=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,n=[0,31,28,31,30,31,30,31,31,30,31,30,31],o=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function i(e){return e.test.bind(e)}let l={date:u,time:p.bind(void 0,!1),"date-time":function(e){let r=e.split(d);return 2==r.length&&u(r[0])&&p(!0,r[1])},duration:e=>e.length>1&&e.length<80&&(/^P\d+([.,]\d+)?W$/.test(e)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(e)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(e)),uri:function(e){return h.test(e)&&f.test(e)},"uri-reference":i(/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i),"uri-template":i(/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i),url:i(/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu),email:e=>{if('"'===e[0])return!1;let[r,t,...s]=e.split("@");return!(!r||!t||0!==s.length||r.length>64||t.length>253||"."===r[0]||r.endsWith(".")||r.includes(".."))&&!!/^[a-z0-9.-]+$/i.test(t)&&!!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(r)&&t.split(".").every(e=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(e))},hostname:i(/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i),ipv4:i(/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/),ipv6:i(/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i),regex:function(e){if(m.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}},uuid:i(/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i),"json-pointer":i(/^(?:\/(?:[^~/]|~0|~1)*)*$/),"json-pointer-uri-fragment":i(/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i),"relative-json-pointer":i(/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/)},c={...l,date:i(/^\d\d\d\d-[0-1]\d-[0-3]\d$/),time:i(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i),"date-time":i(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i),"uri-reference":i(/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i)};function u(e){var r;let t=e.match(a);if(!t)return!1;let s=+t[1],o=+t[2],i=+t[3];return o>=1&&o<=12&&i>=1&&i<=(2==o&&(r=s)%4==0&&(r%100!=0||r%400==0)?29:n[o])}function p(e,r){let t=r.match(o);if(!t)return!1;let s=+t[1],a=+t[2],n=+t[3],i=!!t[5];return(s<=23&&a<=59&&n<=59||23==s&&59==a&&60==n)&&(!e||i)}let d=/t|\s/i,h=/\/|:/,f=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,m=/[^\\]\\Z/},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"2K2FR":[function(e,r,t){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"4eer2":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");function a(e){let r,t=0,s=e.length,a=0;for(;a<s;)t++,(r=e.charCodeAt(a++))>=55296&&r<=56319&&a<s&&(64512&(r=e.charCodeAt(a)))==56320&&a++;return t}s.defineInteropFlag(t),s.export(t,"ucs2length",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],fLAEA:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"validate",()=>function e(r,t,s="2019-09",c=(0,n.dereference)(t),u=!0,p=null,d="#",h="#",f=Object.create(null)){let m;if(!0===t)return{valid:!0,errors:[]};if(!1===t)return{valid:!1,errors:[{instanceLocation:d,keyword:"false",keywordLocation:d,error:"False boolean schema."}]};let b=typeof r;switch(b){case"boolean":case"number":case"string":m=b;break;case"object":m=null===r?"null":Array.isArray(r)?"array":"object";break;default:throw Error(`Instances of "${b}" type are not supported.`)}let{$ref:g,$recursiveRef:j,$recursiveAnchor:y,type:v,const:x,enum:w,required:k,not:_,anyOf:P,allOf:O,oneOf:$,if:M,then:C,else:R,format:I,properties:L,patternProperties:A,additionalProperties:z,unevaluatedProperties:E,minProperties:B,maxProperties:S,propertyNames:T,dependentRequired:F,dependentSchemas:K,dependencies:N,prefixItems:H,items:U,additionalItems:V,unevaluatedItems:q,contains:W,minContains:D,maxContains:X,minItems:Y,maxItems:G,uniqueItems:J,minimum:Q,maximum:Z,exclusiveMinimum:ee,exclusiveMaximum:er,multipleOf:et,minLength:es,maxLength:ea,pattern:en,__absolute_ref__:eo,__absolute_recursive_ref__:ei}=t,el=[];if(!0===y&&null===p&&(p=t),"#"===j){let a=null===p?c[ei]:p,n=`${h}/$recursiveRef`,o=e(r,null===p?t:p,s,c,u,a,d,n,f);o.valid||el.push({instanceLocation:d,keyword:"$recursiveRef",keywordLocation:n,error:"A subschema had errors."},...o.errors)}if(void 0!==g){let t=c[eo||g];if(void 0===t){let e=`Unresolved $ref "${g}".`;throw eo&&eo!==g&&(e+=`  Absolute URI "${eo}".`),Error(e+=`
Known schemas:
- ${Object.keys(c).join("\n- ")}`)}let a=`${h}/$ref`,n=e(r,t,s,c,u,p,d,a,f);if(n.valid||el.push({instanceLocation:d,keyword:"$ref",keywordLocation:a,error:"A subschema had errors."},...n.errors),"4"===s||"7"===s)return{valid:0===el.length,errors:el}}if(Array.isArray(v)){let e=v.length,t=!1;for(let s=0;s<e;s++)if(m===v[s]||"integer"===v[s]&&"number"===m&&r%1==0&&r==r){t=!0;break}t||el.push({instanceLocation:d,keyword:"type",keywordLocation:`${h}/type`,error:`Instance type "${m}" is invalid. Expected "${v.join('", "')}".`})}else"integer"===v?("number"!==m||r%1||r!=r)&&el.push({instanceLocation:d,keyword:"type",keywordLocation:`${h}/type`,error:`Instance type "${m}" is invalid. Expected "${v}".`}):void 0!==v&&m!==v&&el.push({instanceLocation:d,keyword:"type",keywordLocation:`${h}/type`,error:`Instance type "${m}" is invalid. Expected "${v}".`});if(void 0===x||("object"===m||"array"===m?(0,a.deepCompareStrict)(r,x)||el.push({instanceLocation:d,keyword:"const",keywordLocation:`${h}/const`,error:`Instance does not match ${JSON.stringify(x)}.`}):r!==x&&el.push({instanceLocation:d,keyword:"const",keywordLocation:`${h}/const`,error:`Instance does not match ${JSON.stringify(x)}.`})),void 0===w||("object"===m||"array"===m?w.some(e=>(0,a.deepCompareStrict)(r,e))||el.push({instanceLocation:d,keyword:"enum",keywordLocation:`${h}/enum`,error:`Instance does not match any of ${JSON.stringify(w)}.`}):w.some(e=>r===e)||el.push({instanceLocation:d,keyword:"enum",keywordLocation:`${h}/enum`,error:`Instance does not match any of ${JSON.stringify(w)}.`})),void 0!==_){let t=`${h}/not`;e(r,_,s,c,u,p,d,t).valid&&el.push({instanceLocation:d,keyword:"not",keywordLocation:t,error:'Instance matched "not" schema.'})}let ec=[];if(void 0!==P){let t=`${h}/anyOf`,a=el.length,n=!1;for(let a=0;a<P.length;a++){let o=P[a],i=Object.create(f),l=e(r,o,s,c,u,!0===y?p:null,d,`${t}/${a}`,i);el.push(...l.errors),n=n||l.valid,l.valid&&ec.push(i)}n?el.length=a:el.splice(a,0,{instanceLocation:d,keyword:"anyOf",keywordLocation:t,error:"Instance does not match any subschemas."})}if(void 0!==O){let t=`${h}/allOf`,a=el.length,n=!0;for(let a=0;a<O.length;a++){let o=O[a],i=Object.create(f),l=e(r,o,s,c,u,!0===y?p:null,d,`${t}/${a}`,i);el.push(...l.errors),n=n&&l.valid,l.valid&&ec.push(i)}n?el.length=a:el.splice(a,0,{instanceLocation:d,keyword:"allOf",keywordLocation:t,error:"Instance does not match every subschema."})}if(void 0!==$){let t=`${h}/oneOf`,a=el.length,n=$.filter((a,n)=>{let o=Object.create(f),i=e(r,a,s,c,u,!0===y?p:null,d,`${t}/${n}`,o);return el.push(...i.errors),i.valid&&ec.push(o),i.valid}).length;1===n?el.length=a:el.splice(a,0,{instanceLocation:d,keyword:"oneOf",keywordLocation:t,error:`Instance does not match exactly one subschema (${n} matches).`})}if(("object"===m||"array"===m)&&Object.assign(f,...ec),void 0!==M){let t=`${h}/if`;if(e(r,M,s,c,u,p,d,t,f).valid){if(void 0!==C){let a=e(r,C,s,c,u,p,d,`${h}/then`,f);a.valid||el.push({instanceLocation:d,keyword:"if",keywordLocation:t,error:'Instance does not match "then" schema.'},...a.errors)}}else if(void 0!==R){let a=e(r,R,s,c,u,p,d,`${h}/else`,f);a.valid||el.push({instanceLocation:d,keyword:"if",keywordLocation:t,error:'Instance does not match "else" schema.'},...a.errors)}}if("object"===m){if(void 0!==k)for(let e of k)e in r||el.push({instanceLocation:d,keyword:"required",keywordLocation:`${h}/required`,error:`Instance does not have required property "${e}".`});let t=Object.keys(r);if(void 0!==B&&t.length<B&&el.push({instanceLocation:d,keyword:"minProperties",keywordLocation:`${h}/minProperties`,error:`Instance does not have at least ${B} properties.`}),void 0!==S&&t.length>S&&el.push({instanceLocation:d,keyword:"maxProperties",keywordLocation:`${h}/maxProperties`,error:`Instance does not have at least ${S} properties.`}),void 0!==T){let t=`${h}/propertyNames`;for(let a in r){let r=`${d}/${(0,i.encodePointer)(a)}`,n=e(a,T,s,c,u,p,r,t);n.valid||el.push({instanceLocation:d,keyword:"propertyNames",keywordLocation:t,error:`Property name "${a}" does not match schema.`},...n.errors)}}if(void 0!==F){let e=`${h}/dependantRequired`;for(let t in F)if(t in r)for(let s of F[t])s in r||el.push({instanceLocation:d,keyword:"dependentRequired",keywordLocation:e,error:`Instance has "${t}" but does not have "${s}".`})}if(void 0!==K)for(let t in K){let a=`${h}/dependentSchemas`;if(t in r){let n=e(r,K[t],s,c,u,p,d,`${a}/${(0,i.encodePointer)(t)}`,f);n.valid||el.push({instanceLocation:d,keyword:"dependentSchemas",keywordLocation:a,error:`Instance has "${t}" but does not match dependant schema.`},...n.errors)}}if(void 0!==N){let t=`${h}/dependencies`;for(let a in N)if(a in r){let n=N[a];if(Array.isArray(n))for(let e of n)e in r||el.push({instanceLocation:d,keyword:"dependencies",keywordLocation:t,error:`Instance has "${a}" but does not have "${e}".`});else{let o=e(r,n,s,c,u,p,d,`${t}/${(0,i.encodePointer)(a)}`);o.valid||el.push({instanceLocation:d,keyword:"dependencies",keywordLocation:t,error:`Instance has "${a}" but does not match dependant schema.`},...o.errors)}}}let a=Object.create(null),n=!1;if(void 0!==L){let t=`${h}/properties`;for(let o in L){if(!(o in r))continue;let l=`${d}/${(0,i.encodePointer)(o)}`,h=e(r[o],L[o],s,c,u,p,l,`${t}/${(0,i.encodePointer)(o)}`);if(h.valid)f[o]=a[o]=!0;else if(n=u,el.push({instanceLocation:d,keyword:"properties",keywordLocation:t,error:`Property "${o}" does not match schema.`},...h.errors),n)break}}if(!n&&void 0!==A){let t=`${h}/patternProperties`;for(let o in A){let l=new RegExp(o),h=A[o];for(let m in r){if(!l.test(m))continue;let b=`${d}/${(0,i.encodePointer)(m)}`,g=e(r[m],h,s,c,u,p,b,`${t}/${(0,i.encodePointer)(o)}`);g.valid?f[m]=a[m]=!0:(n=u,el.push({instanceLocation:d,keyword:"patternProperties",keywordLocation:t,error:`Property "${m}" matches pattern "${o}" but does not match associated schema.`},...g.errors))}}}if(n||void 0===z){if(!n&&void 0!==E){let t=`${h}/unevaluatedProperties`;for(let a in r)if(!f[a]){let n=`${d}/${(0,i.encodePointer)(a)}`,o=e(r[a],E,s,c,u,p,n,t);o.valid?f[a]=!0:el.push({instanceLocation:d,keyword:"unevaluatedProperties",keywordLocation:t,error:`Property "${a}" does not match unevaluated properties schema.`},...o.errors)}}}else{let t=`${h}/additionalProperties`;for(let o in r){if(a[o])continue;let l=`${d}/${(0,i.encodePointer)(o)}`,h=e(r[o],z,s,c,u,p,l,t);h.valid?f[o]=!0:(n=u,el.push({instanceLocation:d,keyword:"additionalProperties",keywordLocation:t,error:`Property "${o}" does not match additional properties schema.`},...h.errors))}}}else if("array"===m){void 0!==G&&r.length>G&&el.push({instanceLocation:d,keyword:"maxItems",keywordLocation:`${h}/maxItems`,error:`Array has too many items (${r.length} > ${G}).`}),void 0!==Y&&r.length<Y&&el.push({instanceLocation:d,keyword:"minItems",keywordLocation:`${h}/minItems`,error:`Array has too few items (${r.length} < ${Y}).`});let t=r.length,n=0,o=!1;if(void 0!==H){let a=`${h}/prefixItems`,i=Math.min(H.length,t);for(;n<i;n++){let t=e(r[n],H[n],s,c,u,p,`${d}/${n}`,`${a}/${n}`);if(f[n]=!0,!t.valid&&(o=u,el.push({instanceLocation:d,keyword:"prefixItems",keywordLocation:a,error:"Items did not match schema."},...t.errors),o))break}}if(void 0!==U){let a=`${h}/items`;if(Array.isArray(U)){let i=Math.min(U.length,t);for(;n<i;n++){let t=e(r[n],U[n],s,c,u,p,`${d}/${n}`,`${a}/${n}`);if(f[n]=!0,!t.valid&&(o=u,el.push({instanceLocation:d,keyword:"items",keywordLocation:a,error:"Items did not match schema."},...t.errors),o))break}}else for(;n<t;n++){let t=e(r[n],U,s,c,u,p,`${d}/${n}`,a);if(f[n]=!0,!t.valid&&(o=u,el.push({instanceLocation:d,keyword:"items",keywordLocation:a,error:"Items did not match schema."},...t.errors),o))break}if(!o&&void 0!==V){let a=`${h}/additionalItems`;for(;n<t;n++){let t=e(r[n],V,s,c,u,p,`${d}/${n}`,a);f[n]=!0,t.valid||(o=u,el.push({instanceLocation:d,keyword:"additionalItems",keywordLocation:a,error:"Items did not match additional items schema."},...t.errors))}}}if(void 0!==W){if(0===t&&void 0===D)el.push({instanceLocation:d,keyword:"contains",keywordLocation:`${h}/contains`,error:"Array is empty. It must contain at least one item matching the schema."});else if(void 0!==D&&t<D)el.push({instanceLocation:d,keyword:"minContains",keywordLocation:`${h}/minContains`,error:`Array has less items (${t}) than minContains (${D}).`});else{let a=`${h}/contains`,n=el.length,o=0;for(let n=0;n<t;n++){let t=e(r[n],W,s,c,u,p,`${d}/${n}`,a);t.valid?(f[n]=!0,o++):el.push(...t.errors)}o>=(D||0)&&(el.length=n),void 0===D&&void 0===X&&0===o?el.splice(n,0,{instanceLocation:d,keyword:"contains",keywordLocation:a,error:"Array does not contain item matching schema."}):void 0!==D&&o<D?el.push({instanceLocation:d,keyword:"minContains",keywordLocation:`${h}/minContains`,error:`Array must contain at least ${D} items matching schema. Only ${o} items were found.`}):void 0!==X&&o>X&&el.push({instanceLocation:d,keyword:"maxContains",keywordLocation:`${h}/maxContains`,error:`Array may contain at most ${X} items matching schema. ${o} items were found.`})}}if(!o&&void 0!==q){let a=`${h}/unevaluatedItems`;for(;n<t;n++){if(f[n])continue;let t=e(r[n],q,s,c,u,p,`${d}/${n}`,a);f[n]=!0,t.valid||el.push({instanceLocation:d,keyword:"unevaluatedItems",keywordLocation:a,error:"Items did not match unevaluated items schema."},...t.errors)}}if(J)for(let e=0;e<t;e++){let s=r[e],n="object"==typeof s&&null!==s;for(let o=0;o<t;o++){if(e===o)continue;let t=r[o],i="object"==typeof t&&null!==t;(s===t||n&&i&&(0,a.deepCompareStrict)(s,t))&&(el.push({instanceLocation:d,keyword:"uniqueItems",keywordLocation:`${h}/uniqueItems`,error:`Duplicate items at indexes ${e} and ${o}.`}),e=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER)}}}else if("number"===m){if("4"===s?(void 0!==Q&&(!0===ee&&r<=Q||r<Q)&&el.push({instanceLocation:d,keyword:"minimum",keywordLocation:`${h}/minimum`,error:`${r} is less than ${ee?"or equal to ":""} ${Q}.`}),void 0!==Z&&(!0===er&&r>=Z||r>Z)&&el.push({instanceLocation:d,keyword:"maximum",keywordLocation:`${h}/maximum`,error:`${r} is greater than ${er?"or equal to ":""} ${Z}.`})):(void 0!==Q&&r<Q&&el.push({instanceLocation:d,keyword:"minimum",keywordLocation:`${h}/minimum`,error:`${r} is less than ${Q}.`}),void 0!==Z&&r>Z&&el.push({instanceLocation:d,keyword:"maximum",keywordLocation:`${h}/maximum`,error:`${r} is greater than ${Z}.`}),void 0!==ee&&r<=ee&&el.push({instanceLocation:d,keyword:"exclusiveMinimum",keywordLocation:`${h}/exclusiveMinimum`,error:`${r} is less than ${ee}.`}),void 0!==er&&r>=er&&el.push({instanceLocation:d,keyword:"exclusiveMaximum",keywordLocation:`${h}/exclusiveMaximum`,error:`${r} is greater than or equal to ${er}.`})),void 0!==et){let e=r%et;Math.abs(0-e)>=11920929e-14&&Math.abs(et-e)>=11920929e-14&&el.push({instanceLocation:d,keyword:"multipleOf",keywordLocation:`${h}/multipleOf`,error:`${r} is not a multiple of ${et}.`})}}else if("string"===m){let e=void 0===es&&void 0===ea?0:(0,l.ucs2length)(r);void 0!==es&&e<es&&el.push({instanceLocation:d,keyword:"minLength",keywordLocation:`${h}/minLength`,error:`String is too short (${e} < ${es}).`}),void 0!==ea&&e>ea&&el.push({instanceLocation:d,keyword:"maxLength",keywordLocation:`${h}/maxLength`,error:`String is too long (${e} > ${ea}).`}),void 0===en||new RegExp(en).test(r)||el.push({instanceLocation:d,keyword:"pattern",keywordLocation:`${h}/pattern`,error:"String does not match pattern."}),void 0!==I&&o.fastFormat[I]&&!(0,o.fastFormat)[I](r)&&el.push({instanceLocation:d,keyword:"format",keywordLocation:`${h}/format`,error:`String does not match format "${I}".`})}return{valid:0===el.length,errors:el}});var a=e("./deep-compare-strict.js"),n=e("./dereference.js"),o=e("./format.js"),i=e("./pointer.js"),l=e("./ucs2-length.js")},{"./deep-compare-strict.js":"fujar","./dereference.js":"kPeMG","./format.js":"3PtHK","./pointer.js":"aDeec","./ucs2-length.js":"4eer2","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],iFljz:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"Validator",()=>o);var a=e("./dereference.js"),n=e("./validate.js");class o{constructor(e,r="2019-09",t=!0){Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"draft",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"shortCircuit",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lookup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lookup=(0,a.dereference)(e)}validate(e){return(0,n.validate)(e,this.schema,this.draft,this.lookup,this.shortCircuit)}addSchema(e,r){r&&(e={...e,$id:r}),(0,a.dereference)(e,this.lookup)}}},{"./dereference.js":"kPeMG","./validate.js":"fLAEA","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],ehZyh:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"ListOutputParser",()=>n),s.export(t,"CommaSeparatedListOutputParser",()=>o),s.export(t,"CustomListOutputParser",()=>i);var a=e("./base.js");class n extends a.BaseOutputParser{}class o extends n{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"CommaSeparatedListOutputParser"}async parse(e){try{return e.trim().split(",").map(e=>e.trim())}catch(r){throw new a.OutputParserException(`Could not parse output: ${e}`,e)}}getFormatInstructions(){return"Your response should be a list of comma separated values, eg: `foo, bar, baz`"}}class i extends n{constructor({length:e,separator:r}){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"length",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"separator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.length=e,this.separator=r||","}async parse(e){try{let r=e.trim().split(this.separator).map(e=>e.trim());if(void 0!==this.length&&r.length!==this.length)throw new a.OutputParserException(`Incorrect number of items. Expected ${this.length}, got ${r.length}.`);return r}catch(r){if(Object.getPrototypeOf(r)===a.OutputParserException.prototype)throw r;throw new a.OutputParserException(`Could not parse output: ${e}`)}}getFormatInstructions(){return`Your response should be a list of ${void 0===this.length?"":`${this.length} `}items separated by "${this.separator}" (eg: \`foo${this.separator} bar${this.separator} baz\`)`}}},{"./base.js":"9VMS6","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"13QXV":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"StringOutputParser",()=>n);var a=e("./transform.js");class n extends a.BaseTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","string"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"StrOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}},{"./transform.js":"4T2ok","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],"1k6RL":[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t),s.export(t,"Runnable",()=>a.Runnable),s.export(t,"RunnableBinding",()=>a.RunnableBinding),s.export(t,"RunnableEach",()=>a.RunnableEach),s.export(t,"RunnableRetry",()=>a.RunnableRetry),s.export(t,"RunnableSequence",()=>a.RunnableSequence),s.export(t,"RunnableMap",()=>a.RunnableMap),s.export(t,"RunnableLambda",()=>a.RunnableLambda),s.export(t,"RunnableWithFallbacks",()=>a.RunnableWithFallbacks),s.export(t,"_coerceToRunnable",()=>a._coerceToRunnable);var a=e("@langchain/core/runnables")},{"@langchain/core/runnables":"iqnOU","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}],iqnOU:[function(e,r,t){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(t);var a=e("./dist/runnables/index.js");s.exportAll(a,t)},{"./dist/runnables/index.js":"8Mv1g","@parcel/transformer-js/src/esmodule-helpers.js":"jb2Oh"}]},["2maZX","dLYP0"],"dLYP0","parcelRequire3d47"),globalThis.define=r;