!function(){"use strict";function e(){this.AppType="PRNO",this.URLGetExtensionIdAsync="https://api.printnotion.com/extension/getExtensionId",this.URLMain="https://www.printnotion.com/",this.URLgetInfo="https://api.printnotion.com/extension/getInfo",this.URLgetNewVersion="https://www.printnotion.com/extension/NewVersion.html",this.URLgetNews="https://www.printnotion.com/extension/PopupNotes.html",this.UninstallURL="https://www.printnotion.com/uninstalled.html",this.URLCountMeIn="https://www.printnotion.com/count-me-in.html",this.URLPayment="https://www.printnotion.com/payment/products.html",this.URLgetBuyInfo="https://api.printnotion.com/extension/getBuyInfo",this.URLrateChrome="https://chromewebstore.google.com/detail/print-notion/ijaopicbldggjdgbnfdlkljeggibmcha/reviews?from=rate",this.URLrateEdge="https://microsoftedge.microsoft.com/addons/detail/dkejjajekpajnhlmkoboicbifhdafpid?from=rate",this.URLDownloadChrome="https://chromewebstore.google.com/detail/print-notion/ijaopicbldggjdgbnfdlkljeggibmcha",this.URLDownloadEdge="https://microsoftedge.microsoft.com/addons/detail/dkejjajekpajnhlmkoboicbifhdafpid",this.URLPaymentActivationLicense="https://www.printnotion.com/payment/activationLicense.html",this.URLNotionOauth="https://api.printnotion.com/notion/oauth",this.URLNotionConnection="https://api.notion.com/v1/oauth/authorize?owner=user&client_id=127d872b-594c-8040-a33f-0037372c486b&redirect_uri=https%3A%2F%2Fwww.printnotion.com%2Fnotion%2Fredirect.html&response_type=code",this.URLUseCase="https://www.printnotion.com/use-case.html"}var t=new e;function n(e){return e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function o(e,o,i,a,r){return new Promise(((s,l)=>{var c=chrome.runtime.getManifest().version,d="id="+n(e)+"&type1="+n(o+" "+c)+"&type2="+n(i)+"&type3="+n(a)+"&type4="+n(r);fetch(t.URLgetInfo,{method:"POST",headers:{"content-Type":"application/x-www-form-urlencoded"},body:d}).then((e=>e.json())).then((e=>{s(e)})).catch((e=>{l(e)}))}))}function i(){return new Promise(((e,t)=>{fetch("https://www.notion.so/api/v3/getSpaces",{method:"POST",headers:{pragma:"no-cache","cache-control":"no-cache"}}).then((e=>e.json())).then((t=>{e(t)})).catch((t=>{e("")}))}))}function a(e){return new Promise(((t,n)=>{Promise.all(e.map((e=>fetch("https://www.notion.so/api/v3/getPublicSpaceData",{method:"POST",headers:{pragma:"no-cache","cache-control":"no-cache","Content-Type":"application/json"},body:JSON.stringify({type:"space-ids",spaceIds:[e]})}).then((e=>e.json())).then((e=>e)).catch((e=>""))))).then((e=>{let n=e.reduce(((e,t)=>(t.results&&(e=e.concat(t.results)),e)),[]);t({results:n})})).catch((e=>{t("")}))}))}function r(e){return new Promise(((t,n)=>{fetch("https://www.notion.so/api/v3/search",{method:"POST",headers:{pragma:"no-cache","cache-control":"no-cache","Content-Type":"application/json"},body:e}).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{t("")}))}))}function s(e){return new Promise(((t,n)=>{fetch("https://www.notion.so/api/v3/queryCollection?src=change_filter_operator",{method:"POST",headers:{pragma:"no-cache","cache-control":"no-cache","Content-Type":"application/json"},body:e}).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{t("")}))}))}async function l(e,n,o){try{if(await new Promise((e=>{try{chrome.storage.local.get(["analyticsDisabled"],(t=>{e(!!t.analyticsDisabled)}))}catch(t){e(!1)}})))return;const i=function(){try{return new URL(t.URLgetInfo||t.URLGetExtensionIdAsync).origin}catch(e){return"https://testapi.printnotion.com"}}(),a={event_name:e,event_id:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))),params:Object.assign({},o||{}),user:{user_pseudo_id:n},traffic:{source:"chrome_web_store",medium:"organic",campaign:"listing"},context:{page_location:"chrome-extension://background",platform:"extension",locale:chrome.i18n.getUILanguage()||"en",extension_version:chrome.runtime.getManifest().version},session:{session_id:Math.floor(Date.now()/1e3)}};await fetch(`${i}/analytics/collect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}catch(e){}}function c(e){return new Promise(((t,n)=>{fetch("https://www.notion.so/api/v3/syncRecordValues",{method:"POST",headers:{pragma:"no-cache","cache-control":"no-cache","Content-Type":"application/json"},body:e}).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{t("")}))}))}function d(){return document.cookie.split("; ").find((e=>e.startsWith("notion_user_id="))).split("=")[1]}async function u(){var e=await i(),t=Object.keys(e);for(var n in t){var o=e[t[n]].space,a=Object.keys(o);for(var r in a){o[a[r]].value.id;let e=o[a[r]].value.id,t=o[a[r]].value.name;var s='<option value ="'+e+'">'+t+"</option>";$("#space").append(s)}var l=e[t[n]].block,c=Object.keys(l);for(var r in c){let e=l[c[r]].value.id,t=l[c[r]].value.type;if("page"==t){let t=l[c[r]].value.properties.title;s='<option value ="'+e+'">'+t+"</option>";$("#block").append(s)}}$("#block").append('<option value ="0">----</option>');var d=e[t[n]].collection;for(var r in d){let e=d[r],t='<option value ="'+e.value.id+'">'+e.value.name+"</option>";$("#collection").append(t)}}}function m(e,t){try{if("number"==t)return g(e.number,e.number_format);if("rich_text"==t){return e.rich_text.map((e=>e.plain_text)).join(" ")}if("title"==t){return e.title.map((e=>e.plain_text)).join(" ")}if("url"==t)return e.url;if("select"==t)return e.select.name;if("multi_select"==t){return e.map((e=>e.name)).join(" ")}if("created_time"==t)return h(e.created_time);if("boolean"==t)return e.boolean;if("date"==t)return e.date;if("array"==t){let t="";for(var n=0;n<e.array.length;n++)t+=m(e.array[n],e.array[n].type)+",";return t.slice(0,-1)}return""}catch(e){return""}}function g(e,t){if(!e&&0!==e)return"";let n=parseFloat(e);switch(t){case"number_with_commas":return n.toLocaleString();case"percent":return 100*n+"%";case"dollar":case"us_dollar":return"$"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"australian_dollar":return"A$"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"canadian_dollar":return"CA$"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"singapore_dollar":return"SGD"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"hong_kong_dollar":return"HK$"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"new_zealand_dollar":return"NZ$"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"euro":return"‚Ç¨"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"pound":return"¬£"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"franc":return"CHF "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"krona":return"SEK "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"norwegian_krone":return"NOK "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"danish_krone":return"DKK "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"forint":return"HUF "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"koruna":return"CZK "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"zloty":return"PLN "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"leu":return"RON "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"yen":return"¬•"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"yuan":return"CN¬•"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"won":return"‚Ç©"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"rupee":return"‚Çπ"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"rupiah":return"IDR "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"new_taiwan_dollar":return"NT$"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"baht":return"THB "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"shekel":return"‚Ç™"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"philippine_peso":return"‚Ç±"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"ringgit":return"MYR "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"ruble":return"RUB "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"real":return"R$"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"mexican_peso":return"MX$"+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"rand":return"ZAR "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"dirham":return"AED "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"colombian_peso":return"COP "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"riyal":return"SAR "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"argentine_peso":return"ARS "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"uruguayan_peso":return"UYU "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"chilean_peso":return"CLP "+n.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0});case"peruvian_sol":return"PEN "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});case"lira":return"TRY "+n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});default:return n}}async function p(e,t){var n,o={page:{id:t},limit:30,cursor:{stack:[]},chunkNumber:0,verticalColumns:!1},i=await(n=JSON.stringify(o),new Promise(((e,t)=>{fetch("https://www.notion.so/api/v3/loadCachedPageChunk",{method:"POST",headers:{pragma:"no-cache","cache-control":"no-cache","Content-Type":"application/json"},body:n}).then((e=>e.json())).then((t=>{e(t)})).catch((t=>{e("")}))})));return i}function h(e){let t=new Date(e);return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()} ${t.getHours()}:${t.getMinutes()}:${t.getSeconds()}`}async function f(e){try{let n={requests:[]};for(var t=0;t<e.length;t++){let o=e[t].relationData;for(let e=0;e<o.length;e++){let t=o[e][0];if("‚Ä£"==t){if("p"!=o[e][1][0][0])continue;{let t={pointer:{table:"block",id:o[e][1][0][1],spaceId:o[e][1][0][2]},version:-1};n.requests.push(t)}}else if(","==t)continue}}return await c(JSON.stringify(n))}catch(e){return null}}async function y(e,t,n,o,i,a,r){let s=[],l=e.recordMap.block,c=e.result.reducerResults.collection_group_results.blockIds;e.result.reducerResults.collection_group_results.hasMore,e.result.sizeHint;if(0==n&&0==o)for(var d=0;d<c.length&&!(d>0);d++){let b=l[c[d]],_=b.value.properties;if(null!=_){let E={};var u=Object.keys(t);for(var p in u)E[t[u[p]].name]="";s.push(E)}else b.value.id}else{let M=[];var y=0;function C(e,t){return new Promise(((n,o)=>{chrome.runtime.sendMessage({message:e,data:t},(function(e){chrome.runtime.lastError?(chrome.runtime.lastError.message,o(chrome.runtime.lastError.message)):0!=e?.code?o(e?.msg):n(e?.result)}))}))}let x=[];if(r&&null!=i){let U=await C("getDatabasesFromPublicAPI",{collectionViewData:i,user_id:a});if(U?.results)x=U?.results;else{await C("showDialogModal",{title:chrome.i18n.getMessage("js_index_ErrorTitle_NotAuthorized"),content:chrome.i18n.getMessage("js_index_ErrorContent_GetDataFromConnection"),isConfirm:!1})}}function k(e,t){for(var n=0;n<e.length;n++){let o=e[n];if(o.id==t)return o}return null}function P(e,t){let n=e?e.properties:{};for(var o in n){let e=n[o];if(decodeURIComponent(e.id)==t){if("title"==e.type)return e.title.map((e=>e.text.plain_text)).join(" ");if("url"==e.type)return e.url;if("rich_text"==e.type)return e.rich_text.map((e=>e.text.plain_text)).join(" ");if("select"==e.type)return e.select.name;if("multi_select"==e.type)return e.multi_select.map((e=>e.name)).join(" ");if("created_time"==e.type)return h(e.created_time);if("date"==e.type)return e.date.start;if("rollup"==e.type){let t=e.rollup.type;if("number"==t){let t=e.rollup.number;return null!=t?t:""}if("string"==t)return e.rollup.string;if("boolean"==t)return e.rollup.boolean;if("date"==t)return e.rollup.date;if("array"!=t)return"";try{let t="",n=e.rollup.array;if(n.length>0){for(var i=0;i<n.length;i++)t+=m(n[i],n[i].type)+",";return t.slice(0,-1)}return""}catch(e){return""}}if("formula"==e.type){let t=e.formula.type;return"number"==t?e.formula.number:"string"==t?e.formula.string:"boolean"==t?e.formula.boolean:"date"==t?e.formula.date:""}return"relation"==e.type?e.relation.map((e=>e.id)).join(" "):"email"==e.type?e.email:"phone_number"==e.type?e.phone_number:"people"==e.type?e.people.map((e=>e.name)).join(" "):"checkbox"==e.type?e.checkbox:"url"==e.type?e.url:"files"==e.type?e.files.map((e=>e.name)).join(" "):"status"==e.type?e.status.name:"created_by"==e.type?e.created_by.name:"last_edited_by"==e.type?e.last_edited_by.name:"number"==e.type?e.number:"last_edited_time"==e.type?h(e.last_edited_time):"unique_id"==e.type?e.unique_id.number:"button"==e.type?"button":""}}return""}for(d=0;d<c.length;d++){if(d+1<n)continue;if(d+1>o)break;let L=l[c[d]],S=L.value.properties;if(null!=S){let N={};u=Object.keys(t);let D=k(x,c[d]);for(p=0;p<u.length;p++){let O=t[u[p]],T=S[u[p]];if(null!=T)if(O.type,"title"==O.type)N[O.name]=T[0][0];else if("url"==O.type)N[O.name]=T[0][0];else if("text"==O.type)N[O.name]=T[0][0];else if("date"==O.type)N[O.name]=T[0][1][0][1].start_date;else if("select"==O.type)N[O.name]=T[0][0];else if("multi_select"==O.type)N[O.name]=T[0][0];else if("created_time"==O.type)N[O.name]=L.value.created_time;else if("relation"==O.type){u[p];let I=T;N[O.name]="";let R={};R.rowNumber=y,R.column=O.name,R.relationData=I,R.targetProperty="title",R.targetPropertyType="text",M.push(R)}else if("email"==O.type)N[O.name]=T[0][0];else if("phone_number"==O.type)N[O.name]=T[0][0];else if("person"==O.type){let F=P(D,u[p]);N[O.name]=F}else if("checkbox"==O.type)N[O.name]=T[0][0];else if("url"==O.type)N[O.name]=T[0][0];else if("file"==O.type)N[O.name]=T[0][0];else if("status"==O.type)N[O.name]=T[0][0];else if("created_by"==O.type){let j=P(D,u[p]);N[O.name]=j}else if("last_edited_by"==O.type){let V=P(D,u[p]);N[O.name]=V}else if("number"==O.type)N[O.name]=g(T[0][0],O.number_format);else if("last_edited_time"==O.type)N[O.name]=T[0][0];else if("auto_increment_id"==O.type)N[O.name]=T[0][0];else if("formula"==O.type){let q=P(D,u[p]);N[O.name]=g(q,O.number_format)}else if("rollup"==O.type){let G=P(D,u[p]);N[O.name]=g(G,O.number_format)}else u[p],N[O.name]=T;else if("created_time"==O.type)N[O.name]=h(L.value.created_time);else if("formula"==O.type){let K=P(D,u[p]);u[p],N[O.name]=g(K,O.number_format)}else if("rollup"==O.type){let z=P(D,u[p]);N[O.name]=z}else{let Y=P(D,u[p]);N[O.name]=Y}}s.push(N),y+=1}else L.value.id}let B=await f(M);for(;null!=B;){for(var w=[],A=0;A<M.length;A++){let $=M[A];s[$.rowNumber][$.column]=v(B,$,w)}if(!(w.length>0))break;B=await f(w),M=w}}return s}function v(e,t,n){let o=[],i=[],a={},r=t.relationData,s=t.targetProperty,l=t.targetPropertyType;for(let t=0;t<r.length;t++){let n=r[t][0];if("‚Ä£"==n){if("p"!=r[t][1][0][0])continue;{let n=e.recordMap.block[r[t][1][0][1]];if(void 0!==n.value){let e=n.value.properties[s];if(void 0!==e)if("relation"==l)for(var c=0;c<e.length;c++){var d=e[c];try{let e=d[0];if("‚Ä£"==e){let e=d[1][0][0]+"|"+d[1][0][1]+"|"+d[1][0][2];a.hasOwnProperty(e)||(i.push(d),a[e]=d)}else if(","==e)continue}catch(e){i.push(d)}}else if("date"==l){if("‚Ä£"==e[0][0]){if("d"==e[0][1][0][0]){let t=e[0][1][0][1];"daterange"==t.type?o.push(t.start_date+"‚Üí"+t.end_date):"datetimerange"==t.type?o.push(t.start_date+" "+t.start_time+"‚Üí"+(t.start_date==t.end_date?"":t.end_date+" ")+t.end_time):o.push(t.start_date)}}}else{let t="";try{t=e,void 0!==t&&o.push(t)}catch(e){}}}}}else if(","==n)continue}if("relation"==l){let e={};return e.rowNumber=t.rowNumber,e.column=t.column,e.relationData=i,e.targetProperty="title",e.targetPropertyType="text",n.push(e),""}return o.join(", ")}async function w(e,t,n,o,i){let a=[];if(i&&(i.value.hasOwnProperty("format")||i.value.format.hasOwnProperty("property_filters"))){let e=i.value.format.property_filters;if(e&&null!=e&&e.length>0)for(let t of e){let e=t.filter;a.push(e)}}var r={collectionView:{id:n,spaceId:e},source:{type:"collection",id:t,spaceId:e},loader:{type:"reducer",reducers:{collection_group_results:{type:"results",limit:1e3}},filter:{operator:"and",filters:a},sort:[],searchQuery:"",userId:o,userTimeZone:"Asia/Shanghai"}},l=await s(JSON.stringify(r));return l}function A(e){let t=e.match(/{[^{}<>]+}/g);if(t){let e=t.map((e=>e.slice(1,-1)));return e}return[]}function b(e){let t={},n=e.recordMap.collection;n||(n={});let o=Object.keys(n);for(let e in o){let r=n[o[e]].value.schema;var i=Object.keys(r);for(var a in i)t[i[a]]=r[i[a]]}return t}async function _(e){let t=e.recordMap.collection;t||(t={});let n=Object.keys(t);for(let e in n){let o=t[n[e]].value.parent_id,i=E(await p(0,o));return i}}function E(e){let t=[],n=e.recordMap.collection_view,o=Object.keys(n);for(let e in o){let i=n[o[e]],a=[];if(void 0!==i.value.format){let e=i.value.format.table_properties;void 0!==e&&(a=a.concat(e));let t=i.value.format.list_properties;void 0!==t&&(a=a.concat(t));let n=i.value.format.property_filters;void 0!==n&&(a=a.concat(n))}let r={id:i.value.id,name:i.value.name,properties:a,collectionViewData:i};t.push(r)}return t}async function M(){var e=(await L.get("buyInfo")).buyInfo;return e&&e.result?e.result:null}async function C(e,n){var i=document.getElementById("iframe-container");if(!i||i.getAttribute("issidepeek")!=String(e)){if(i){if(e){if(!confirm(chrome.i18n.getMessage("js_form_AlreadyExistMainPage")))return}else if(!confirm(chrome.i18n.getMessage("js_form_AlreadyExistSidePeek")))return;var a=document.getElementById("close-button-form");a&&a.click()}if(!(i=document.getElementById("iframe-container"))){var r=document.createElement("div");r.id="iframe-container",r.role="dialog",r.style.position="fixed",r.style.width="600px",r.style.height="520px",r.style.zIndex="1000",r.style.backgroundColor="rgba(255, 255, 255)",r.style.border="1px solid rgba(255, 255, 255, 0)",r.setAttribute("issidepeek",e),document.body.insertBefore(r,document.body.firstChild);let u="üñ®Ô∏è Print Notion";u=e?chrome.i18n.getMessage("js_form_PrintingSidePeek"):chrome.i18n.getMessage("js_form_PrintingMainPage");var s=document.createElement("div");s.id="iframe-container-title",s.innerHTML='<div id="dialog-top-form" style="all:unset; align-items: center;background-color: rgb(255, 255, 255);box-shadow: rgb(234, 234, 234) 0px -1px inset;cursor: grab; display: inline-flex;height: 40px;left: 0px;padding: 0px 8px 0px 12px;position: absolute; right: 0px;top: 0px;">\n                <div style="all:unset; color: rgb(51, 51, 51);  font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen-Sans, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, sans-serif;    font-size: 13px;     font-weight: 500;flex: 1 1 0%;line-height: 15px;    margin: 0px;padding: 0px 0px 0px 8px;">'+u+'\n                <a id="buttonFree" href="javascript:void(0);" style="display:none;margin-left: 6px;"><img src="data:image/png;base64,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" style="width: 38px; height: 14px;" /></a>\n                <a id="buttonVIP" href="javascript:void(0);" style="display:none;margin-left: 6px;"><img src="data:image/png;base64,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" style="width: 38px; height: 14px;" /></a>\n                </div>\n             <div style="display:flex; gap: 4px; align-items:center;"> \n             \n             <div tabindex="0" role="button" aria-label="Expand web clipper" id="expand-button-form" style="all:unset; color: rgba(0, 0, 0, 0.5);border-radius: 999px;cursor: pointer;padding: 6px;margin-left:-2px; opacity:1;display:none;">\n              <svg style="all:unset; display: block !important;" width="15" height="16" viewBox="0 0 15 19" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M8.38377 2.36625C8.14936 2.13191 7.83148 2.00027 7.50002 2.00027C7.16857 2.00027 6.85068 2.13191 6.61627 2.36625L2.86627 6.11625C2.63857 6.352 2.51258 6.66776 2.51543 6.9955C2.51828 7.32325 2.64974 7.63676 2.8815 7.86852C3.11326 8.10028 3.42677 8.23174 3.75452 8.23459C4.08226 8.23744 4.39802 8.11145 4.63377 7.88375L7.50002 5.0175L10.3663 7.88375C10.602 8.11145 10.9178 8.23744 11.2455 8.23459C11.5733 8.23174 11.8868 8.10028 12.1185 7.86852C12.3503 7.63676 12.4818 7.32325 12.4846 6.9955C12.4875 6.66776 12.3615 6.352 12.1338 6.11625L8.38377 2.36625Z" fill="currentColor"></path>\n                <path d="M10.3662 11.1163L7.49998 13.9825L4.63373 11.1163C4.51842 10.9969 4.38049 10.9016 4.22799 10.8361C4.07548 10.7706 3.91146 10.7361 3.74548 10.7347C3.57951 10.7332 3.41491 10.7649 3.26129 10.8277C3.10767 10.8906 2.9681 10.9834 2.85074 11.1008C2.73337 11.2181 2.64055 11.3577 2.5777 11.5113C2.51485 11.6649 2.48322 11.8295 2.48467 11.9955C2.48611 12.1615 2.52059 12.3255 2.5861 12.478C2.65161 12.6305 2.74684 12.7684 2.86623 12.8838L6.61623 16.6338C6.85064 16.8681 7.16852 16.9997 7.49998 16.9997C7.83143 16.9997 8.14932 16.8681 8.38373 16.6338L12.1337 12.8838C12.2531 12.7684 12.3483 12.6305 12.4139 12.478C12.4794 12.3255 12.5139 12.1615 12.5153 11.9955C12.5167 11.8295 12.4851 11.6649 12.4223 11.5113C12.3594 11.3577 12.2666 11.2181 12.1492 11.1008C12.0319 10.9834 11.8923 10.8906 11.7387 10.8277C11.5851 10.7649 11.4205 10.7332 11.2545 10.7347C11.0885 10.7361 10.9245 10.7706 10.772 10.8361C10.6195 10.9016 10.4815 10.9969 10.3662 11.1163Z" fill="currentColor"></path>\n              </svg>\n        \n             </div>\n        \n              <div tabindex="0" role="button" aria-label="Close web clipper" id="close-button-form" style="all:unset; color: rgba(0, 0, 0, 0.5);border-radius: 999px;cursor: pointer;padding: 6px;margin-left:-2px;">\n                <svg style="all:unset; display: block !important;" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n                  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.0539 4.55972C13.2434 4.37015 13.2432 4.05082 13.0461 3.85373L12.3456 3.15325C12.1401 2.94773 11.8325 2.95269 11.6396 3.14551L8.09968 6.68547L4.55972 3.14551C4.37015 2.95593 4.05082 2.95616 3.85373 3.15325L3.15325 3.85373C2.94773 4.05925 2.95269 4.36691 3.14551 4.55972L6.68547 8.09968L3.14551 11.6396C2.95593 11.8292 2.95616 12.1485 3.15325 12.3456L3.85373 13.0461C4.05925 13.2516 4.36691 13.2467 4.55972 13.0539L8.09968 9.5139L11.6396 13.0539C11.8292 13.2434 12.1485 13.2432 12.3456 13.0461L13.0461 12.3456C13.2516 12.1401 13.2467 11.8325 13.0539 11.6396L9.5139 8.09968L13.0539 4.55972Z" fill="currentColor"></path>\n                </svg>\n              </div>\n            </div>\n            </div>',r.appendChild(s);var l=document.createElement("div");l.id="iframe-container-body",l.style.width="100%",l.style.height="100%",l.style.marginTop="40px";var c=document.createElement("iframe");c.src=chrome.runtime.getURL("pages/index.html?isSidePeek="+e),c.style.width="100%",c.style.height="90%",c.id="embedded-iframe",c.frameBorder="0",c.allowFullscreen=!0,l.appendChild(c);document.getElementsByTagName("main");r.appendChild(l);var d=await M();d?($("#buttonVIP").show(),$("#buttonFree").hide()):($("#buttonFree").show(),$("#buttonVIP").hide());let m,g,p=!1;function h(e){p=!0,m=e.clientX-r.getBoundingClientRect().left,g=e.clientY-r.getBoundingClientRect().top}function f(e){p=!1}function y(e){if(p){const t=e.clientX-m,n=e.clientY-g;r.style.left=t+"px",r.style.top=n+"px"}}r.addEventListener("mousedown",h),document.addEventListener("mousemove",y),document.addEventListener("mouseup",f),$("#close-button-form").click((async function(e){$("#iframe-container").remove(),r.removeEventListener("mousedown",h),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",f)})),$("#buttonFree").click((function(e){S.getExtensionId().then((e=>{o(e,"PRNO","buttonFree","",""),window.open(t.URLPayment+"?id="+e,"_blank")}))})),$("#buttonVIP").click((async function(e){chrome.runtime.sendMessage({greeting:"updateVIPInfo"},(function(e){e.farewell}));var t=await M();S.getExtensionId().then((e=>{o(e,"PRNO","buttonVIP",JSON.stringify(t),"")})),alert(chrome.i18n.getMessage("js_form_Msg_ProVersion"))})),$((async function(){"LOAD"==n&&$("#buttonRefreshSpace").trigger("click")}))}}}function x(e){if(!document.getElementById("myModal")){var t=document.createElement("div");t.id="myModal",t.className="modal fade",t.tabIndex="-1",t.setAttribute("aria-labelledby","exampleModalLabel"),t.setAttribute("aria-hidden","true"),t.innerHTML='\n                                      <div class="modal-dialog modal-xl">\n                                        <div class="modal-content">\n                                          <div class="modal-header">\n                                            <h1 class="modal-title fs-5" id="ModalFormTitle"></h1>\n                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                                          </div>\n                                          <div class="modal-body">\n                                          <div class="alert alert-secondary" role="alert">\n                                          <div class="table-container">\n                                              <table id="tableCheckParameters" class="table table-sm table-striped">\n                                              </table>\n                                          </div>\n                                      </div>\n                                          </div>\n                                          <div class="modal-footer">\n                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">'+chrome.i18n.getMessage("js_form_Modal_ButtonClose")+"</button>\n                                          </div>\n                                        </div>\n                                      </div>\n                                    ",document.body.insertBefore(t,document.body.firstChild)}$("#ModalFormTitle").text(e)}function k(e){if(!document.getElementById("ModalMessage")){var t=document.createElement("div");t.id="ModalMessage",t.className="modal fade",t.tabIndex="-1",t.setAttribute("aria-labelledby","exampleModalLabel"),t.setAttribute("aria-hidden","true"),t.innerHTML='\n                                      <div class="modal-dialog modal-xl">\n                                        <div class="modal-content">\n                                          <div class="modal-header">\n                                            <h1 class="modal-title fs-5" style="padding-bottom: 10px" id="ModalMessageFormTitle"></h1>\n                                          </div>\n                                        </div>\n                                      </div>\n                                    ',document.body.insertBefore(t,document.body.firstChild)}$("#ModalMessageFormTitle").text(e)}function P(e,t,n,o,i){let a=document.createElement("div");a.id=t,a.setAttribute("parentMenuId",n),a.classList.add("drop-down-menu-group"),e.appendChild(a);let r=document.createElement("div");r.classList.add("drop-down-menu-group-layer1"),a.appendChild(r);let s=document.createElement("div");s.classList.add("drop-down-menu-group-layer2"),r.appendChild(s);let l=document.createElement("div");l.classList.add("drop-down-menu-group-layer3"),s.appendChild(l);let c=document.createElement("div");c.classList.add("drop-down-menu-group-layer4"),l.appendChild(c);let d=document.createElement("div");c.appendChild(d);let u=document.createElement("div");u.classList.add("drop-down-menu-group-layer6"),d.appendChild(u);for(var m=0;m<o.length;m++)if(o[m],"----"==o[m]){let e=document.createElement("div");e.id=t+"_button_"+m,e.classList.add("drop-down-menu-group-menu-splitter"),u.appendChild(e)}else{let e=document.createElement("div");e.id=t+"_button_"+m,e.classList.add("drop-down-menu-group-menu"),o[m].endsWith(">>>>")&&e.setAttribute("hasSubMenu","true"),u.appendChild(e);let n=document.createElement("div");n.classList.add("drop-down-menu-group-menu-layer1"),e.appendChild(n);let i=document.createElement("div");i.classList.add("drop-down-menu-group-menu-layer2"),n.appendChild(i);let a=document.createElement("div");a.classList.add("drop-down-menu-group-menu-layer3"),i.appendChild(a);let r=document.createElement("div");r.classList.add("drop-down-menu-group-menu-title");let s=o[m].replace(/>>>>$/,"");if(r.innerText=s,n.appendChild(r),o[m].endsWith(">>>>")){let e=document.createElement("div");e.classList.add("drop-down-menu-group-menu-submenu"),n.appendChild(e);let t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("drop-down-menu-group-menu-submenu-icon"),t.setAttribute("viewBox","0 0 16 16"),e.appendChild(t);let o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"),t.appendChild(o)}}let g=document.createElement("footer");g.classList.add("drop-down-menu-group-footer"),l.appendChild(g),e.appendChild(a),$("#"+t+" .drop-down-menu-group-menu").unbind("click").bind("click",(async function(e){e.currentTarget.id;let n=e.currentTarget.id;var o=new RegExp(t+"_button_([0-9]+)$"),a=n.match(o);if(a){var r=a[1];i[r](n);var s=$("#"+t);s.hide();var l=s.attr("parentMenuId");$("#"+l).hide()}}))}function B(e,t,n,o,i,a,r){!function(e,t,n){let o=document.createElement("div");o.classList.add("drop-down-button-group");let i=document.createElement("div");i.id=t,i.classList.add("drop-down-button-group-button"),i.innerText=n,o.appendChild(i);let a=document.createElement("div");a.id=t+"_menubutton",a.classList.add("drop-down-button-group-menu"),o.appendChild(a);let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.id=t+"_icon",r.classList.add("drop-down-button-group-menu-icon"),r.setAttribute("viewBox","0 0 30 30"),a.appendChild(r);let s=document.createElementNS("http://www.w3.org/2000/svg","polygon");s.setAttribute("points","15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "),r.appendChild(s);let l=document.createElement("div");l.classList.add("drop-down-button-group-thirddiv"),o.appendChild(l),e.appendChild(o)}(e,t,n);let s=t+"_menu",l="#"+s,c="#"+t,d=c+"_icon",u=c+"_menubutton";P(e,s,"",a),$(c).unbind("click").bind("click",(async function(e){o(e)}));for(var m=[],g=0;g<a.length;g++)if(a[g],m.push(s+"_button_"+g),a[g].endsWith(">>>>")){var p=r[g];let e=l+"_button_"+g;var h=p("GET_SUBMENUID");p("CREATE_SUBMENU");var f,y=$(e);y.on("mouseenter",(function(){f=setTimeout((function(){p("BUTTON_MOUSEENTER");let t,n=$("#"+h);n.on("mouseenter",(function(){clearTimeout(t),p("SUBMENU_MOUSEENTER")}));var o=e;n.on("mouseleave",(function(){t=setTimeout((function(){p("SUBMENU_MOUSELEAVE",o),$(document).off("click",p)}),200)}))}),200)})),y.on("mouseleave",(function(){f=setTimeout((function(){clearTimeout(f),p("BUTTON_MOUSELEAVE")}),200)})),$('[id^="'+s+'_button_"]').on("mouseenter",(function(){this.id;for(var e=0;e<m.length;e++)m[e],this.id,m[e]==this.id?(r[e]("BUTTON_MOUSEENTER"),r[e]):(r[e]("BUTTON_MOUSELEAVE"),r[e])}))}$(l+" .drop-down-menu-group-menu").unbind("click").bind("click",(async function(e){e.currentTarget.id;let t=e.currentTarget.id;var n=new RegExp(s+"_button_([0-9]+)$"),o=t.match(n);if(o){var i=o[1];r[i]("BUTTON_CLICK");var a=$(l),c=$("#"+t);if(c.attr("hasSubMenu"),"true"!=c.attr("hasSubMenu")){a.hide();for(var d=0;d<m.length;d++)r[d]("SUBMENU_HIDE"),r[d]}}})),$(u).unbind("click").bind("click",(async function(e){i(e);var t=$(u),n=$(l),o=t.offset(),a=(n.outerWidth(),$(window).width()),r=a-(o.left+t.outerWidth());n.css({top:o.top+t.outerHeight(),right:r,position:"fixed"}),n.toggle()})),$(document).on("click",(function(e){var t=$(l),n=$(u),o=$(d),i=$(d+" polygon"),a=$(c);if(e.target.classList,!($(e.target).is(t)||$(e.target).is(n)||$(e.target).is(o)||$(e.target).is(i)||$(e.target).is(a)||e.target.classList.contains("drop-down-menu-group-menu-title"))){t.hide();for(var s=0;s<m.length;s++)r[s]("SUBMENU_HIDE"),r[s]}}))}t=new e;var U=new function(){this.log=function(e){},this.log=function(e,t){},this.log=function(e,t,n){}},L=new function(){this.set=function(e,t){return new Promise(((n,o)=>{chrome.storage.sync.set({[e]:t},(function(o){n({[e]:t})}))}))},this.get=function(e){return new Promise(((t,n)=>{chrome.storage.sync.get({[e]:null},(function(e){t(e)}))}))},this.remove=function(e){return new Promise(((t,n)=>{chrome.storage.sync.remove(e,(function(n){t({[e]:null})}))}))},this.clear=function(){return new Promise(((e,t)=>{chrome.storage.sync.clear((function(t){e(1)}))}))},this.set=function(e,t,n){return new Promise(((o,i)=>{"LOCAL"===n?chrome.storage.local.set({[e]:t},(function(n){o({[e]:t})})):chrome.storage.sync.set({[e]:t},(function(n){o({[e]:t})}))}))},this.get=function(e,t){return new Promise(((n,o)=>{"LOCAL"===t?chrome.storage.local.get({[e]:null},(function(e){n(e)})):chrome.storage.sync.get({[e]:null},(function(e){n(e)}))}))},this.remove=function(e,t){return new Promise(((n,o)=>{"LOCAL"===t?chrome.storage.local.remove(e,(function(t){n({[e]:null})})):chrome.storage.sync.remove(e,(function(t){n({[e]:null})}))}))},this.clear=async function(e){return new Promise(((t,n)=>{"LOCAL"===e?chrome.storage.local.clear((function(e){t({})})):chrome.storage.sync.clear((function(e){t({})}))}))}},S=new function(){this.getExtensionId=async function(){var e=await L.get("extensionId");if(e.extensionId&&null!=e.extensionId)return e.extensionId;try{var n=await function(e){return new Promise(((n,o)=>{t.URLGetExtensionIdAsync,fetch(t.URLGetExtensionIdAsync,{method:"POST",headers:{"content-Type":"application/x-www-form-urlencoded"},body:"id="+e}).then((e=>e.json())).then((e=>{0===e.code?n(e.result.deviceId):n(null)})).catch((e=>{o(e)}))}))}("PRNO");return await L.set("extensionId",n),n}catch(e){return null}},this.getNewVersion=async function(){try{var e=await new Promise(((e,n)=>{fetch(t.URLgetNewVersion,{method:"GET",headers:{pragma:"no-cache","cache-control":"no-cache"}}).then((e=>e.text())).then((t=>{e(t)})).catch((t=>{var n=chrome.runtime.getManifest().version;e(n)}))}));return await L.set("newVersion",e),e}catch(e){return null}},this.getInstallMarket=function(){try{let e=chrome.runtime.getManifest(),t="unknown";if(e.update_url){let n=e.update_url;n.includes("edge.microsoft")?t="edge":n.includes("clients2.google")&&(t="google")}return t}catch(e){return"google"}},this.getRateUrl=function(){try{let e=this.getInstallMarket(),n=t.URLrateChrome;return"edge"==e?n=t.URLrateEdge:"google"==e&&(n=t.URLrateChrome),n}catch(e){return t.URLrateChrome}}};function N(e){try{const t=new URL(e);let n=t.pathname.replace(/[a-f0-9]{32}/gi,"[ID]");return t.origin+n}catch(e){return"invalid-url"}}function D(e){if(!e)return"Unknown error";let t=e.toString();return t=t.replace(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,"[EMAIL]"),t=t.replace(/[a-f0-9]{32,}/gi,"[TOKEN]"),t=t.replace(/https?:\/\/[^\s]+/g,"[URL]"),t=t.replace(/@[\w-]+/g,"[USERNAME]"),t.substring(0,200)}function O(e){if(!e)return"";let t=e;return t=t.replace(/chrome-extension:\/\/[a-z]+\//g,""),t=t.replace(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,"[EMAIL]"),t=t.replace(/[a-f0-9]{32,}/gi,"[TOKEN]"),t.substring(0,300)}function T(e){return window.btoa(unescape(encodeURIComponent(e)))}function I(e){return new Promise((t=>setTimeout(t,e)))}async function u(){try{var e=await i(),t=Object.keys(e),n="";for(var o in t){var a=e[t[o]].notion_user[t[o]],r=a.value.email,s=a.value.name,c=a.value.family_name,d=a.value.given_name;n=n+r+"|"+(void 0===s?"":s)+"|"+(void 0===c?"":c)+"|"+(void 0===d?"":d)+"|"}return n}catch(e){return S.getExtensionId().then((async t=>{try{await l("error_get_spaces",t,{error_message:D(e),error_type:e.name||"Unknown"})}catch(e){}})),"|"+e}}async function R(){var e=(await L.get("buyInfo")).buyInfo;return e&&e.result?e.result:null}async function M(){G+=1;var e=await L.get("buyInfo"),t=e.buyInfo;return null!=t&&null!=t.result||(chrome.runtime.sendMessage({greeting:"updateVIPInfo"},(function(e){e.farewell})),!1)}async function F(){if(!document.getElementById("buttonPrintNotion")){var e=document.getElementsByClassName("notion-topbar-action-buttons");if(e.length>0){document.body.className.indexOf("dark");var n="buttonPrintNotion",i=n+"_menu",a="menuSubmenu",r="#"+a;B(e[0],n,chrome.i18n.getMessage("js_content_Menu_PrintNotion"),(async function(e){try{try{const e=await S.getExtensionId();await l("button_print_notion_click",e,{})}catch(e){}await R();const m=document.body.className.indexOf("dark")>=0;if(!await te())return void resolve("Cancel");$("#buttonPrintNotion").text(chrome.i18n.getMessage("js_content_Modal_Msg_Processing")),$("#buttonPrintNotion").addClass("disabledButton"),$("#buttonPrintNotion_menubutton").addClass("disabledButton"),$("#buttonPrintNotion").disabled=!0;var n=Date.now(),i=await u();S.getExtensionId().then((e=>{o(e,t.AppType,"Export","Click",T(document.URL+"|"+i))}));var a=await L.get("paperType"),r=await L.get("paperOrientation");try{var s=document.querySelector("#notion-app > div > div:nth-child(1) > div > div:nth-child(2) > main > div > div.whenContentEditable > div > div:nth-child(2) > div > div > div:nth-child(2) > div > div.notion-selectable.notion-page-block > h1");void 0!==s&&null!=s||(s=document.querySelector("#notion-app > div > div:nth-child(1) > div > div:nth-child(2) > main > div > div:nth-child(2) > div:nth-child(2) > div:nth-child(2) > div > div > div.notion-selectable.notion-collection_view_page-block > h1"));var c=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});s.dispatchEvent(c)}catch{}k(chrome.i18n.getMessage("js_content_Modal_Msg_Processing")),$("#ModalMessage").modal("show"),await I(500),await async function(){return new Promise((async(e,t)=>{$("#buttonPrintNotion").text(chrome.i18n.getMessage("js_content_Msg_Processing1of5"));let n=K(!1);$("#buttonPrintNotion").text(chrome.i18n.getMessage("js_content_Msg_Processing2of5"));var o=$('<div id="newBody" style="display:none" class="notion-body"></div>');o.append(n),R().then((e=>{if(!e){var t='\n        <div style="align-items: center; justify-content: center; "> <a href="https://www.printnotion.com"\n        target="_blank">\n        <div style="display: flex; align-items: center; justify-content: center;">\n          <img src="data:image/png;base64,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"\n            style="width: 38px; height: 38px; margin-right: 10px;" />\n          <b>'+chrome.i18n.getMessage("js_content_Msg_ExportedBy")+"</b>\n        </div>\n      </a>\n    </div>";o.append(t)}})),$("html").append(o),$("#buttonPrintNotion").text(chrome.i18n.getMessage("js_content_Msg_Processing3of5")),$("#newBody").imagesLoaded().done((function(t){$("body").hide(),o.show(),$("#buttonPrintNotion").text(chrome.i18n.getMessage("js_content_Msg_Processing4of5")),window.print(),$("#newBody").remove(),$("body").show(),e(null)})).fail((function(){t("error:ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•ÔºÅ")}))}))}(a.paperType,r.paperOrientation),$("#ModalMessage").modal("hide"),m&&ne();var d=Date.now();S.getExtensionId().then((e=>{o(e,t.AppType,"Export","End",d-n)}))}catch(e){S.getExtensionId().then((async n=>{o(n,t.AppType,"Export","Error",e);try{await l("error_print_notion_main",n,{error_message:D(e),error_stack:O(e.stack),error_type:e.name||"Unknown",page_url:N(window.location.href)})}catch(e){}}))}finally{$("#buttonPrintNotion").text(chrome.i18n.getMessage("js_content_ButtonNameFull")),$("#buttonPrintNotion").removeClass("disabledButton"),$("#buttonPrintNotion_menubutton").removeClass("disabledButton"),$("#buttonPrintNotion").disabled=!1}}),(function(e){R().then((e=>{e?($(".ProFlag").hide(),$("#rowsRadiosGroup1").hide(),$("input[name='rowsRadios'][value='all']").prop("checked",!0)):($(".ProFlag").show(),$("#rowsRadiosGroup1").show()),e?($("#buttonPrintNotion_menu_button_0").hide(),$("#buttonPrintNotion_menu_button_1").hide(),$("#buttonPrintNotion_menu_button_5").hide(),$("#buttonPrintNotion_menu_button_6").hide()):($("#buttonPrintNotion_menu_button_0").show(),$("#buttonPrintNotion_menu_button_1").show(),$("#buttonPrintNotion_menu_button_5").show(),$("#buttonPrintNotion_menu_button_6").show()),$("#buttonPrintNotion_menu_button_8").hide()}))}),[chrome.i18n.getMessage("js_content_Menu_RemoveLogo"),"----",chrome.i18n.getMessage("js_content_Menu_PrintingWithTable"),chrome.i18n.getMessage("js_content_Menu_InsertPageBreak"),"----",chrome.i18n.getMessage("js_content_Menu_UpgradePro"),chrome.i18n.getMessage("js_index_ActivationLicense"),chrome.i18n.getMessage("js_content_Menu_UserManual"),"Menu>>>>"],[function(e,n){"BUTTON_MOUSEENTER"==e||"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||S.getExtensionId().then((async e=>{try{await l("menu_remove_logo_click",e,{})}catch(e){}window.open(t.URLPayment+"?id="+e,"_blank")}))},function(e,t){},async function(e,t){var n="#menuSubmenu",o=$(n);if("BUTTON_MOUSEENTER"==e)o.hide();else if("SUBMENU_HIDE"==e);else if("BUTTON_MOUSELEAVE"==e);else{try{const e=await S.getExtensionId();await l("menu_printing_with_table_data_click",e,{})}catch(e){}await C(!1,"LOAD")}},function(e,t){"BUTTON_MOUSEENTER"==e||"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||(S.getExtensionId().then((async e=>{try{await l("menu_insert_page_break_click",e,{})}catch(e){}})),H())},function(e,t){},function(e,n){"BUTTON_MOUSEENTER"==e||"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||S.getExtensionId().then((async e=>{try{await l("menu_upgrade_pro_click",e,{})}catch(e){}window.open(t.URLPayment+"?id="+e,"_blank")}))},function(e,n){"BUTTON_MOUSEENTER"==e||"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||S.getExtensionId().then((async e=>{try{await l("menu_activation_license_click",e,{})}catch(e){}window.open(t.URLPaymentActivationLicense+"?id="+e,"_blank")}))},function(e,n){var o=$(r);"BUTTON_MOUSEENTER"==e?o.hide():"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||(S.getExtensionId().then((async e=>{try{await l("menu_user_manual_click",e,{})}catch(e){}})),window.open(t.URLMain+"PrintNotionUserManual.html","_blank"))},function(t,n){var o=$(r),s="#"+i+"_button_3",l=$(s);if("CREATE_SUBMENU"==t)P(e[0],a,i,["Sub1","Sub2"],[function(){alert("sub1"),k("TEXT"),$("#ModalMessage").modal("show")},function(){alert("sub2"),k("TEXT")}]);else if("BUTTON_MOUSEENTER"==t){var c=l.offset(),d=(o.outerWidth(),$(window).width()),u=d-c.left;o.css({top:c.top,right:u,position:"fixed"}),o.show()}else if("BUTTON_MOUSELEAVE"==t);else if("SUBMENU_MOUSEENTER"==t)o.show();else if("SUBMENU_MOUSELEAVE"==t);else{if("GET_SUBMENUID"==t)return a;"SUBMENU_HIDE"==t?o.hide():"BUTTON_CLICK"==t&&o.toggle()}}])}}}function j(){if(!document.getElementById("buttonSidePeekPrintNotion")){var e=document.getElementsByClassName("notion-topbar-more-button");if(e.length,e.length>=2){document.body.className.indexOf("dark");var n="buttonSidePeekPrintNotion",i=n+"_menu",a="menuSubmenu",r="#"+a;B(e[1].parentNode,n,chrome.i18n.getMessage("js_content_ButtonNameFull"),(async function(e){try{try{const e=await S.getExtensionId();await l("button_print_notion_sidepeek_click",e,{})}catch(e){}$("#buttonSidePeekPrintNotion").text("Processing..."),$("#buttonSidePeekPrintNotion").addClass("disabledButton"),$("#buttonSidePeekPrintNotion_menubutton").addClass("disabledButton"),$("#buttonSidePeekPrintNotion").disabled=!0;let m=await M();if(!m)return void(1==confirm(chrome.i18n.getMessage("js_content_Msg_SidePeekPurchase"))&&S.getExtensionId().then((e=>{o(e,"PRNO","buttonPage","EnterPage",""),window.open(t.URLPayment+"?id="+e,"_blank")})));const g=document.body.className.indexOf("dark")>=0;if(!await te())return void resolve("Cancel");var n=Date.now(),i=await u();S.getExtensionId().then((e=>{o(e,t.AppType,"Export","Click",T(document.URL+"|"+i))}));var a=await L.get("paperType"),r=await L.get("paperOrientation");try{var s=document.querySelector("#notion-app > div > div:nth-child(1) > div > div:nth-child(2) > main > div > div.whenContentEditable > div > div:nth-child(2) > div > div > div:nth-child(2) > div > div.notion-selectable.notion-page-block > h1");void 0!==s&&null!=s||(s=document.querySelector("#notion-app > div > div:nth-child(1) > div > div:nth-child(2) > main > div > div:nth-child(2) > div:nth-child(2) > div:nth-child(2) > div > div > div.notion-selectable.notion-collection_view_page-block > h1"));var c=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});s.dispatchEvent(c)}catch{}k(chrome.i18n.getMessage("js_content_Modal_Msg_Processing")),$("#ModalMessage").modal("show"),await I(500),await async function(){return new Promise((async(e,t)=>{$("#buttonSidePeekPrintNotion").text(chrome.i18n.getMessage("js_content_Msg_Processing1of5"));let n=K(!0);$("#buttonSidePeekPrintNotion").text(chrome.i18n.getMessage("js_content_Msg_Processing2of5"));var o=document.title,i=V(o),a=$('<div id="newBody" style="display:none" class="notion-body"></div>');a.append(n),R().then((e=>{if(!e){var t='\n        <div style="align-items: center; justify-content: center; "> <a href="https://www.printnotion.com"\n        target="_blank">\n        <div style="display: flex; align-items: center; justify-content: center;">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAUKADAAQAAAABAAAAUAAAAAAx4ExPAAAHiklEQVR4Ae2dTWhUOxTHT2vV4geCpViLgqj4sdCiFSylXagoiKgPKoJLdedHV9LF40FRfBVFBBd+oIiiG12IVXGtUOhC30NEUFtQtErLq7ixVVCqeecfm5i5kzuT3tyW6UwOpMkkObk5v8lJ5n6lZeQm5VytkcMfHOo51I6GWRwXgwyzEf2j4V+OOzl0c/jJwUsqWbuNw38cRIkF2AzbwSCRtLBWH4dSAxe1FwzAwiplllzkHefwp1m2YMEC2rlzJ23bto2WLFlCtbW1NGtWcXjw8PAw9ff30+vXr+nBgwd09+5d+vDhg2k+0h0c/uIAwLECeDc56G+BQYnLly+LkZERUSoCW2EzbDdZjLKxDTou+iV/c6SVduzYIT5//lwq3LLshO1gYDLhNBhZBX6uK7e2toofP35kNVpqGWBw+PBhzWWUUdaciJVGLxigHuD9HipgERmJYJWxOmO5lpTh96Xstr+xZabAJDIngpmUcv6rf+dh8gxiJwA2zEoFMCvHitLEoYsD4afK27dvacqUKfiYSI4ePZpIbyKV2tvbEx2OXZkWLVpk/sRpRkOnOUiqBw8etKMfQ65qq5DjMZiTVRWMDNtOV/CHeg5S8CM5LUn6Lad1fFs7aXgHGJ07d041Xw8X7uGwDDk9PT20bJlM4mMiKStDkzykBb6owpI0+tbb20vLly9XhvXC2iEO8pxsaGjI+/QsjU6q3qUdp9E3nPbNnj1bdW0YAPVQSWPUpNFJ1bu047T6ptpB//ATJogHgQDQAx5UA8AA0JOAp3oYgQGgJwFP9TACPQFCXZ/bZZ34ccaVK1dEfX29mDZtmq5n6hRjGrbCZthuk4jN8QDb2tpKBloEirYbDKISqWsH+OLFC1FeXq4biiiVTD4YgIUpJovYObCrq4t+/vS+Mc/HmtwCBmARJ7icZRXcJ7XJ0qVLafHixdTX10evXr3SVXCPeM2aNVRRUUFPnjwhnHQridNR5YUex7FQ/dbuaA5Tvp6n87miTG/cuFHwFWt5w+nly5diw4YNMp/hiQsXLgiGJgPSyINenI5qczLEYGFKpM/2OdAG8Pbt22Y74tatWxISQAKeEqSbm5tlWZxOpBOybqHm5QIYOweyMVnCd+wz8uCukGg+8uLKVD7qFIOMCeDFixflvIeJ9d27d/rS9tOnT+nGjRv05csXGZDGPAiJ0ykGeMoG7T7KBRHbXJgVxIoVK8SWLVsELwxaD/mY8+DKcF01/yE/l44qL/Q4lwvHrsJslFWw8pqrr6qEVffhw4fqY0Ycp5NRaZJ+GJMLT1Ibx7XbAaAn3gAwAPQk4KkeRmAA6EnAUz2MwADQk4CnehiBAaAnAU/1MZ/KuR6PT6ddq05YPfOhoLQOGlzYk2QAGAB6EvBUDyPQE+C4LSJmvz59+kTfv383s6zpwcFB4hda5KsEtkv/aOfr1680f/58fcvA2pCRWVVVRfykgZGTbjIWIL+Vk9qR8PA6jM8nb968Ib4JRfv376e5c+dmVX/06BF1dnZSR0cHzZgxI6vcltHY2EiA6CP5WOhL8+Ylfd8nE8y2XNN79+6Vfdm1a5f4+PFjltr27dtlOd9vySpzyWCI2lbXNJ5MwC1cU0zd2BG4cuVKOnLkCJ06dcrny5O6ri787ds3Wr9+Pd25c4eampqopaXF+tYU3iYYGBhw6pevC4MB3weKPVYsQGicPHlSvhNx/vx5ev78udM8ZjuSqwsDzLx582jOnDl04sQJGdvcD08K4B6MiyRxYcyZq1atogMHDtC+ffvyHkYPa3OYJk3z0WR7SfThonCZY8eOyRhPNbx//143lZYL6wYTJpSNiHOOwLzoHSu4ujCawz3nuro62rp1q9y/4NKlS3JRMVfSiXThfCZOCEBXF1adBaDdu3fTs2fP6OzZs7Rw4UKqqalRxXKDiPF0YX0gx0RBuTD3WahV9urVq2Lq1KmCR6Tgd9REcGHHb1S5aENDA+3Zs4euX79OZ86cIZ4fZQuq3KU531U43zEK0oXNVXbz5s30+PFjunbtmlwVYZBZns/AJKtwvjaj5QXrwmqRvHfvnpg5c6bgBzsFj0rt4qrcNWbDE/9CMI+h2kE8KS4mbNq0iQ4dOkQ41WOQBBcuFJkQF+7u7nY6F+ZvmXDVGC81R880Vq9eTfzkF6EtPFp3//59J4bj7cITAhBveLtcjZk+fbqEtG7dOvOlZg2qsrJSbviwdu1aqq6u1vm5EsbL0bmqJS4LL1wnQGfeW8EcqE8qXX+cJjhm0ahEGA0BoH6fId/j/EVDwcOQCKOBDIDYPy8twTAvtJCGbRFG/QCIPUOlYPPBILkJRBj9g0Uk1a2fch9+cpfatn7CCOzmMAjTsO0ln8AjGcRCAGyMrUHBDOykhO3vzHM1SzrX9ncgGDZgtEBTWS4bMAJiCwd9YSFsAfoLH+C5bAEKgJCwCa0adhzDbSNbf2KAxW5CC4BYlW9y0CMR216GbZA1D7ABIy0ZH0ZzkXecQ9iIW2OSiQ7+m3cjblMFc2IfBz0aSzQNBmCRSLA64yeO3qSW06UC1OmfEdhc2EYaP7gbOYR/hxGh8z8O2BHy5d3dDAAAAABJRU5ErkJggg=="\n            style="width: 38px; height: 38px; margin-right: 10px;" />\n          <b>'+chrome.i18n.getMessage("js_content_Msg_ExportedBy")+"</b>\n        </div>\n      </a>\n    </div>";a.append(t)}})),$("html").append(a),$("#buttonSidePeekPrintNotion").text(chrome.i18n.getMessage("js_content_Msg_Processing3of5")),$("#newBody").imagesLoaded().done((function(t){$("body").hide(),a.show(),$("#buttonSidePeekPrintNotion").text(chrome.i18n.getMessage("js_content_Msg_Processing4of5")),document.title=i,window.print(),document.title=o,$("#newBody").remove(),$("body").show(),e(null)})).fail((function(){document.title=o,t("error:Image loading failed!")}))}))}(a.paperType,r.paperOrientation),$("#ModalMessage").modal("hide"),g&&ne();var d=Date.now();S.getExtensionId().then((e=>{o(e,t.AppType,"Export","End",d-n)}))}catch(e){S.getExtensionId().then((async n=>{o(n,t.AppType,"Export","Error",e);try{await l("error_print_notion_sidepeek",n,{error_message:D(e),error_stack:O(e.stack),error_type:e.name||"Unknown",page_url:N(window.location.href)})}catch(e){}}))}finally{$("#buttonSidePeekPrintNotion").text(chrome.i18n.getMessage("js_content_ButtonNameFull")),$("#buttonSidePeekPrintNotion").removeClass("disabledButton"),$("#buttonSidePeekPrintNotion_menubutton").removeClass("disabledButton"),$("#buttonSidePeekPrintNotion").disabled=!1}}),(function(e){R().then((e=>{e?($(".ProFlag").hide(),$("#rowsRadiosGroup1").hide(),$("input[name='rowsRadios'][value='all']").prop("checked",!0)):($(".ProFlag").show(),$("#rowsRadiosGroup1").show()),e?$("#buttonSidePeekPrintNotion_menu_button_3").hide():$("#buttonSidePeekPrintNotion_menu_button_3").show(),$("#buttonSidePeekPrintNotion_menu_button_5").hide()}))}),[chrome.i18n.getMessage("js_content_Menu_PrintingWithTable"),chrome.i18n.getMessage("js_content_Menu_InsertPageBreak"),"----",chrome.i18n.getMessage("js_content_Menu_UpgradePro"),chrome.i18n.getMessage("js_content_Menu_UserManual"),"ËèúÂçï2>>>>"],[async function(e,t){var n="#menuSubmenu",o=$(n);"BUTTON_MOUSEENTER"==e?o.hide():"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||await C(!0,"LOAD")},function(e,t){"BUTTON_MOUSEENTER"==e||"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||H()},function(e,t){},function(e,n){"BUTTON_MOUSEENTER"==e||"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||S.getExtensionId().then((e=>{window.open(t.URLPayment+"?id="+e,"_blank")}))},function(e,n){var o=$(r);"BUTTON_MOUSEENTER"==e?o.hide():"SUBMENU_HIDE"==e||"BUTTON_MOUSELEAVE"==e||window.open(t.URLMain+"PrintNotionUserManual.html","_blank")},function(t,n){var o=$(r),s="#"+i+"_button_3",l=$(s);if("CREATE_SUBMENU"==t)P(e[0],a,i,["Sub1","Sub2"],[function(){alert("sub1")},function(){alert("sub2")}]);else if("BUTTON_MOUSEENTER"==t){var c=l.offset(),d=(o.outerWidth(),$(window).width()),u=d-c.left;o.css({top:c.top,right:u,position:"fixed"}),o.show()}else if("BUTTON_MOUSELEAVE"==t);else if("SUBMENU_MOUSEENTER"==t)o.show();else if("SUBMENU_MOUSELEAVE"==t);else{if("GET_SUBMENUID"==t)return a;"SUBMENU_HIDE"==t?o.hide():"BUTTON_CLICK"==t&&o.toggle()}}])}}}function V(e){var t="";try{let e=document.getElementsByClassName("notion-peek-renderer")[0].getElementsByClassName("notion-scroller vertical")[0].getElementsByClassName("layout-content")[0].getElementsByClassName("notion-selectable notion-page-block");e.length>0&&(e[0].innerText,t=e[0].innerText)}catch(e){S.getExtensionId().then((async t=>{try{await l("error_get_sidepeek_title",t,{error_message:D(e),error_type:"page_title",page_url:N(window.location.href)})}catch(e){}}))}if(""==t)try{let e=document.getElementsByClassName("notion-peek-renderer")[0].getElementsByClassName("notion-scroller vertical")[0].getElementsByClassName("notion-selectable notion-collection_view_page-block");e.length>0&&(e[0].innerText,t=e[0].innerText)}catch(e){S.getExtensionId().then((async t=>{try{await l("error_get_sidepeek_title",t,{error_message:D(e),error_type:"collection_title",page_url:N(window.location.href)})}catch(e){}}))}return""==t?e:t}var q=null,G=0;function K(e){let t=null,n=null,o=null;if(e){t=document.getElementsByClassName("notion-peek-renderer")[0].getElementsByClassName("notion-scroller vertical")[0],n=t.cloneNode(!0)}else t=document.getElementsByClassName("notion-frame")[0],n=t.cloneNode(!0),o=n.getElementsByClassName("notion-selectable notion-page-block"),o.length>0&&o[0];let i=n.getElementsByClassName("notion-margin-discussion-item");if(i.length>0){i[0],i[0].remove();let e=n.getElementsByTagName("span");for(var a=0;a<e.length;a++)e[a],e[a].getAttribute("class"),null!=e[a].getAttribute("class")&&-1!=e[a].getAttribute("class").indexOf("discussion-id")&&e[a].setAttribute("style","");let t=n.getElementsByClassName("whenContentEditable")[0];var r=t.getElementsByTagName("div");for(a=0;a<r.length;a++){if(null!=(l=r[a].getAttribute("style"))&&-1!=l.indexOf("transform: translateX(")){var s=/transform: translateX\([0-9,.,-]*px\);/gi;let e=l.replace(s,"");r[a].setAttribute("style",e)}}let o=n.getElementsByTagName("main");for(a=0;a<o.length;a++){o[a];var l,c=o[a].getElementsByTagName("div")[0];if(-1!=(l=c.getAttribute("style")).indexOf("transform: translateX(")){s=/transform: translateX\([0-9,.,-]*px\);/gi;let e=l.replace(s,"");c.setAttribute("style",e)}}}let d=n.getElementsByClassName("hide-scrollbar ignore-scrolling-container");d.length>0&&d[0].remove();let u=n.getElementsByClassName("autolayout-row autolayout-fill-width autolayout-center autolayout-space");u.length>0&&u[0].parentNode.remove(),n.setAttribute("style","width: auto;");let m=n.innerHTML;document.body.className.indexOf("dark");let g={'<span style="height: 1px; width: 1px; caret-color: transparent;"></span>':"","padding-bottom: 30vh;":""};var p=Object.keys(g);for(var h in p){var f=p[h].replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),y=new RegExp(f,"g");m=m.replace(y,g[p[h]]),p[h],g[p[h]]}return m=J(m),m}async function z(e,t){return new Promise((n=>{var o=$("#newBody");o.imagesLoaded().done((function(i){$("body").hide(),o.show(),null==e&&null==t?window.print():(document.title=t,window.print(),document.title=e),n(null)})).fail((function(){reject("error:ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•ÔºÅ")}))}))}$((async function(){var e=document.URL;if(e.indexOf("payment/success.html")>=0){var n=document.referrer;if(n.indexOf("payment/products.html")>=0||n.indexOf("payment/activationLicense.html")>=0){var i={code:0,msg:"Temp",createTime:(new Date).getTime(),result:{id:"0"}};await L.set("buyInfo",i),S.getExtensionId().then((e=>{o(e,"PRNO","paymentsuccess","save temp buyInfo","")}))}S.getExtensionId().then((e=>{o(e,"PRNO","paymentsuccess","Activating start","")})),M().then((e=>{e?($("#notifications").html(chrome.i18n.getMessage("js_content_Msg_ActivationSuccess")),$("#pronote").show(),$("#proimage").show(),$("#loading").hide(),null!=q&&(clearInterval(q),q=null)):null==q&&(CvipInfoTimer=setInterval((function(){G>40&&($("#notifications").html(chrome.i18n.getMessage("js_content_Msg_ActivationFailed")),clearInterval(q),q=null),M().then((e=>{e&&($("#notifications").html(chrome.i18n.getMessage("js_content_Msg_ActivationSuccess")),$("#pronote").show(),$("#proimage").show(),$("#loading").hide(),null!=q&&(clearInterval(q),q=null))})).catch((e=>{S.getExtensionId().then((async t=>{try{await l("error_vip_activation_retry",t,{error_message:D(e),page_url:N(window.location.href)})}catch(e){}}))}))}),4e3))})).catch((e=>{S.getExtensionId().then((async t=>{try{await l("error_vip_activation_initial",t,{error_message:D(e),page_url:N(window.location.href)})}catch(e){}}))}))}if(e.indexOf("notion/redirect.html")>=0){async function a(e,n){return new Promise(((o,i)=>{fetch(t.URLNotionOauth,{method:"POST",headers:{"content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({code:e,state:n}).toString()}).then((e=>e.json())).then((e=>{o(e)})).catch((e=>{S.getExtensionId().then((async t=>{try{await l("error_notion_oauth",t,{error_message:D(e),page_url:N(window.location.href)})}catch(e){}})),i(e)}))}))}setTimeout((async function(){var e=new URLSearchParams(window.location.search),t=e.get("code"),n=e.get("state");let o=await a(t,n);0==o.code?(L.get("notionTokens").then((e=>{let t=e?.notionTokens?e?.notionTokens:{},n=o.result?.workspace_id,i=o.result?.access_token,a=o.result?.owner?.user?.id;t[`${a}|${n}`]={user_id:a,workspace_id:n,access_token:i},L.set("notionTokens",t)})),$("#successnote").show(),$("#loading").hide(),$("#notifications").hide()):($("#successnote").text("Connection failed, please go back to Print Notion and click the 'Authorize' button to try again"),$("#successnote").show(),$("#loading").hide(),$("#notifications").hide())}),1e3)}await async function(){chrome.runtime.sendMessage({message:"getNewVersion"},(function(e){}));var e=chrome.runtime.getManifest().version,t=await L.get("newVersion");return(t=t?t.newVersion:e)>e}()||setInterval((async()=>{var e=document.URL;e.indexOf("notion.so")>=0&&(await F(),j())}),4e3)})),chrome.runtime.onMessage.addListener(((e,t,n)=>{if(e.message,"getButtonSize"===e.message&&L.get("buttonSize").then((e=>{"Small"==e.buttonSize?$("#buttonPDF").prop("value",chrome.i18n.getMessage("js_content_ButtonNameShort")):$("#buttonPDF").prop("value",chrome.i18n.getMessage("js_content_ButtonNameFull"))})),"printButton"===e.message){const t=document.body.className.indexOf("dark")>=0;te().then((o=>{if(!o)return n("Cancel"),!0;k(chrome.i18n.getMessage("js_content_Modal_Msg_Processing")),$("#ModalMessage").modal("show"),I(500).then((()=>{let o=e.data.isGetDataFromConnection;e.data.isSidePeek?async function(e,t,n,o,i,a,r,s){return new Promise((async(l,c)=>{let u=document.getElementsByClassName("notion-peek-renderer");if(u.length>0){if(u[0].getElementsByClassName("notion-scroller vertical").length<=0)return alert(chrome.i18n.getMessage("js_content_Msg_NoSidePeek")),void l("Cancel")}let m=K(!0),g=A(m);if(g.length<=0&&!confirm(chrome.i18n.getMessage("js_content_Modal_Msg_NoPrintParameters")))return void l("Cancel");var p=d();let h=await w(t,n,o,p,r.collectionViewData),f=b(h),v=h.result.sizeHint;if(-1==i&&-1==a&&(i=1,a=v),i>v)return alert(chrome.i18n.getMessage("js_content_Modal_Msg_LessBeginningRow")),void l("Cancel");a>v&&(a=v,alert(chrome.i18n.getMessage("js_content_Modal_Msg_LessEndingRow")));let _=await y(h,f,i,a,r.collectionViewData,p,s);var E=document.title,M=V(E);if(1==e){var C="";for(let e in _){let t=m;_[e];for(let n in g)g[n],_[e].hasOwnProperty(g[n])&&(_[e][g[n]],t=t.replace("{"+g[n]+"}",_[e][g[n]]));C+=t,_.length>1&&(C+="<div style='page-break-after: always;'></div>")}C=J(C),(x=$('<div id="newBody" style="display:none" class="notion-body"></div>')).append(C),$("html").append(x),await z(E,M),$("#newBody").remove(),$("body").show(),l(null)}else{for(let e in _){let t=m;for(let n in g)g[n],_[e].hasOwnProperty(g[n])&&(_[e][g[n]],t=t.replace("{"+g[n]+"}",_[e][g[n]]));var x;t=J(t),(x=$('<div id="newBody" style="display:none" class="notion-body"></div>')).append(t),$("#newBody").remove(),$("html").append(x),await z(E,M)}$("#newBody").remove(),$("body").show(),l(null)}}))}(e.data.isSinglePage,e.data.spaceId,e.data.collectionId,e.data.collectionViewId,e.data.rangeBegin,e.data.rangeEnd,e.data.collectionViewInfo,o).then((function(e){$("#ModalMessage").modal("hide"),t&&ne(),n(e)})).catch((function(e){return $("#ModalMessage").modal("hide"),t&&ne(),S.getExtensionId().then((async t=>{try{await l("error_print_with_database_sidepeek",t,{error_message:D(e),page_url:N(window.location.href)})}catch(e){}})),n("Cancel"),!0})):async function(e,t,n,o,i,a,r,s){return new Promise((async(l,c)=>{let u=K(!1),m=A(u);if(m.length<=0&&!confirm(chrome.i18n.getMessage("js_content_Modal_Msg_NoPrintParameters")))return void l("Cancel");var g=d();let p=await w(t,n,o,g,r.collectionViewData),h=b(p),f=p.result.sizeHint;if(-1==i&&-1==a&&(i=1,a=f),i>f)return alert(chrome.i18n.getMessage("js_content_Modal_Msg_LessBeginningRow")),void l("Cancel");a>f&&(a=f,alert(chrome.i18n.getMessage("js_content_Modal_Msg_LessEndingRow")));let v=await y(p,h,i,a,r.collectionViewData,g,s);if(1==e){var _="";for(let e in v){let t=u;v[e];for(let n in m)m[n],v[e].hasOwnProperty(m[n])&&(v[e][m[n]],t=t.replace("{"+m[n]+"}",v[e][m[n]]));_+=t,v.length>1&&(_+="<div style='page-break-after: always;'></div>")}_=J(_),(E=$('<div id="newBody" style="display:none" class="notion-body"></div>')).append(_),$("html").append(E),await z(null,null),$("#newBody").remove(),$("body").show(),l(null)}else{for(let e in v){let t=u;for(let n in m)m[n],v[e].hasOwnProperty(m[n])&&(v[e][m[n]],t=t.replace("{"+m[n]+"}",v[e][m[n]]));var E;t=J(t),(E=$('<div id="newBody" style="display:none" class="notion-body"></div>')).append(t),$("#newBody").remove(),$("html").append(E),await z(null,null)}$("#newBody").remove(),$("body").show(),l(null)}}))}(e.data.isSinglePage,e.data.spaceId,e.data.collectionId,e.data.collectionViewId,e.data.rangeBegin,e.data.rangeEnd,e.data.collectionViewInfo,o).then((function(e){$("#ModalMessage").modal("hide"),t&&ne(),n(e)})).catch((function(e){return $("#ModalMessage").modal("hide"),t&&ne(),S.getExtensionId().then((async t=>{try{await l("error_print_with_database_main",t,{error_message:D(e),page_url:N(window.location.href)})}catch(e){}})),n("Cancel"),!0}))})).catch((function(e){return $("#ModalMessage").modal("hide"),t&&ne(),S.getExtensionId().then((async t=>{try{await l("error_print_modal_timeout",t,{error_message:D(e),page_url:N(window.location.href)})}catch(e){}})),n("Cancel"),!0}))}))}if("getParamentersFromDoc"===e.message){let e=A(document.getElementsByClassName("notion-frame")[0].cloneNode(!0).innerHTML);n(e)}if("getNotionUserId"===e.message){let e=d();n(e)}if("buttonCheckParameters"===e.message){let t=e.data.spaceId,i=e.data.collectionId,a=e.data.collectionViewId;w(t,i,a,o=d()).then((async function(e){x(chrome.i18n.getMessage("js_content_Modal_ParameterChecking"));let t=b(e),o=await y(e,t,0,0,null,null,!1),i={tableData:o,tableHeaders:t,tableHeaderOrder:(await _(e))[0].properties},a=A(document.getElementsByClassName("notion-frame")[0].cloneNode(!0).innerHTML);var r=[];let s=1;var l=Object.keys(a);if(l.length>0){for(let e in l){l[e],a[l[e]];let t={};t.Number=s,t.Parameters=a[l[e]],o[0].hasOwnProperty(a[l[e]])?t.Matches=!0:t.Matches=!1,r.push(t),s+=1}!function(e,t){e.empty();let n="<thead><tr>";var o=null==t[0]||null==t[0]?[]:Object.keys(t[0]);for(let e in o)n=n+'<th scope="col">'+o[e]+"</th>";n+="</tr></thead>",e.append(n);let i="<tbody>";$.each(t,(function(e,t){var n="<tr>";for(let e in o)n=0==e?n+'<th scope="row">'+t[o[e]]+"</th>":n+"<td>"+t[o[e]]+"</td>";i+=n+="</tr>"})),i+="</tbody>",e.append(i)}($("#tableCheckParameters"),r),$("#myModal").modal("show")}else alert(chrome.i18n.getMessage("js_content_Modal_NoValidParameters"));n(i)}))}if("buttonDataPreview"===e.message){let t=e.data.spaceId,i=e.data.collectionId,a=e.data.collectionViewInfo,r=e.data.rangeBegin,l=e.data.rangeEnd,c=e.data.isGetDataFromConnection,u=e.data.collectionViewInfo.id,m=e.data.collectionViewInfo.collectionViewData;var o=d();(async function(e,t,n,o,i){let a=[];if(o.value.hasOwnProperty("format")||o.value.format.hasOwnProperty("property_filters")){let e=o.value.format.property_filters;if(e&&null!=e&&e.length>0)for(let t of e){let e=t.filter;a.push(e)}}var r={collectionView:{id:n,spaceId:e},source:{type:"collection",id:t,spaceId:e},loader:{type:"reducer",reducers:{collection_group_results:{type:"results",limit:1e3}},filter:{operator:"and",filters:a},sort:[],searchQuery:"",userId:i,userTimeZone:"Asia/Shanghai"}};return o.value.hasOwnProperty("query2")?(o.value.query2.hasOwnProperty("sort")?r.loader.sort=o.value.query2.sort:r.loader.sort=[],o.value.query2.hasOwnProperty("filter")&&(r.loader.filter=o.value.query2.filter)):r.loader.sort=[],await s(JSON.stringify(r))})(t,i,u,m,o).then((async function(e){x(chrome.i18n.getMessage("js_content_Modal_DataPreview"));let t=b(e),i=e.result.sizeHint;if(-1==r&&-1==l&&(r=1,l=i),r>i)return alert(chrome.i18n.getMessage("js_content_Modal_Msg_LessBeginningRow")),void n({error:!0});l>i&&(l=i,alert(chrome.i18n.getMessage("js_content_Modal_Msg_LessEndingRow")));let s=await y(e,t,r,l,m,o,c),d=(await _(e),{error:!1,tableData:s,tableHeaders:t,tableHeaderOrder:a.properties,collectionViewData:a.collectionViewData});!function(e,t,n,o){e.empty();let i="<thead><tr>";for(var a in o){o[a];let e=o[a].property;try{i=i+'<th scope="col">'+n[e].name+"</th>"}catch(e){}}i+="</tr></thead>",e.append(i);let r="<tbody>";$.each(t,(function(e,t){var i="<tr>";for(var a in o){let e=o[a].property;if(0==a)i=i+'<th scope="row">'+t[n[e].name]+"</th>";else try{i=i+"<td>"+t[n[e].name]+"</td>"}catch(e){}}r+=i+="</tr>"})),r+="</tbody>",e.append(r)}($("#tableCheckParameters"),s,t,a.properties),$("#myModal").modal("show"),n(d)}))}if("getSpacesAsync"===e.message&&i().then((function(e){var t={},o={},i=[],r=d(),s=e,l=Object.keys(s);for(var c in l){var u=l[c];if(r==u){var m=s[l[c]].notion_user[u].value.name,g=s[l[c]].space;if(null==g){g=s[l[c]].user_root[u].value.space_view_pointers;var p=Object.keys(g);for(var h in p){s[l[c]].user_root[u].value.space_view_pointers[p[h]];let e=s[l[c]].user_root[u].value.space_view_pointers[p[h]].spaceId,n="space"+h;t[e]={id:e,spaceName:n,userId:u,userName:m}}}else{p=Object.keys(g);for(var h in p){g[p[h]].value.id;let e=g[p[h]].value.id,n=g[p[h]].value.name;t[e]={id:e,spaceName:n,userId:u,userName:m}}}var f=s[l[c]].space_view;if(null==f)for(var y in t)o[y]={id:y,spaceName:"",userId:u,userName:m},i.push(y);else{var v=Object.keys(f);for(var w in v){let e=f[v[w]].value.space_id;t.hasOwnProperty(e)?o[e]=t[e]:(o[e]={id:e,spaceName:"",userId:u,userName:m},i.push(e))}}}}i.length>0?a(i).then((function(e){var t=e.results,i=Object.keys(t);for(var a in i){var r=t[i[a]];let e=r.id,n=r.name;o[e].spaceName=n}n(o)})):n(o)})),"getSearchAsync"===e.message&&r(JSON.stringify(e.data)).then((function(e){n(e)})),"queryCollection"===e.message){let t=e.data.spaceId,i=e.data.collectionId,a=e.data.collectionViewId,r=e.data.collectionViewData;w(t,i,a,o=d(),r).then((function(e){n(e)}))}if("getloadCachedPageChunk"===e.message){e.data.spaceId;p(0,e.data.pageId).then((function(e){n(e)}))}return"ChangeWindowHeight"===e.message&&("ShowCollectionView"==e.data&&$("#iframe-container").height("580px"),"HideCollectionView"==e.data&&$("#iframe-container").height("520px"),n(!0)),e.message,e.data,!0}));const Y="====Print Notion Page Break====";async function H(){try{await navigator.clipboard.writeText(Y),X(chrome.i18n.getMessage("js_content_Modal_PageBreakTitle"),chrome.i18n.getMessage("js_content_Modal_PageBreakMessage"),chrome.i18n.getMessage("js_content_Modal_PageBreakInstructions")),$("#ModalPageBreak").modal("show")}catch(e){U.error("Failed to copy page break marker to clipboard:",e),S.getExtensionId().then((async t=>{try{await l("error_page_break_clipboard",t,{error_message:D(e),error_type:e.name||"Unknown"})}catch(e){}})),X(chrome.i18n.getMessage("js_content_Modal_PageBreakTitle"),chrome.i18n.getMessage("js_content_Modal_PageBreakManualCopy")+" "+Y,chrome.i18n.getMessage("js_content_Modal_PageBreakInstructions")),$("#ModalPageBreak").modal("show")}}function X(e,t,n){if(!document.getElementById("ModalPageBreak")){var o=document.createElement("div");o.id="ModalPageBreak",o.className="modal fade",o.tabIndex="-1",o.setAttribute("aria-labelledby","ModalPageBreakTitle"),o.setAttribute("aria-hidden","true"),o.innerHTML=`\n            <div class="modal-dialog modal-lg">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h1 class="modal-title fs-5" id="ModalPageBreakTitle"></h1>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="${chrome.i18n.getMessage("js_index_Close")}"></button>\n                    </div>\n                    <div class="modal-body">\n                        <div class="alert alert-info" role="alert">\n                            <div id="ModalPageBreakMessage" style="margin-bottom: 15px;"></div>\n                            <div id="ModalPageBreakInstructions" style="font-size: 14px; color: #666;"></div>\n                        </div>\n                        <div class="text-center" style="margin-top: 15px;">\n                            <code style="background-color: #f8f9fa; padding: 8px; border-radius: 4px; font-weight: bold;">\n                                ${Y}\n                            </code>\n                        </div>\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">${chrome.i18n.getMessage("js_index_Close")}</button>\n                    </div>\n                </div>\n            </div>\n        `,document.body.insertBefore(o,document.body.firstChild)}$("#ModalPageBreakTitle").text(e),$("#ModalPageBreakMessage").text(t),$("#ModalPageBreakInstructions").text(n)}function J(e){let t=e.replace(new RegExp(Y,"g"),'<div style="page-break-before: always; break-before: page; height: 0; margin: 0; padding: 0;"></div>');return e.length,t.length,(e.match(new RegExp(Y,"g"))||[]).length,t}function Q(){}"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",Q);const W="DARK_MODE_NO_SHOW_AGAIN";function Z(e=!1){const t=document.body.className.indexOf("dark")>=0;!t&&e&&ee(),t&&!e&&ee()}function ee(){const e=navigator.platform.toLowerCase().includes("mac"),t={key:"l",code:"KeyL",keyCode:76,which:76,shiftKey:!0,bubbles:!0,cancelable:!0};e?(t.metaKey=!0,t.ctrlKey=!1):(t.ctrlKey=!0,t.metaKey=!1),["keydown","keypress","keyup"].forEach((e=>{document.dispatchEvent(new KeyboardEvent(e,t))}))}async function te(){return new Promise((async(e,t)=>{if(!(document.body.className.indexOf("dark")>=0))return void e(!0);if(!await async function(){try{return!(await L.get(W))[W]}catch(e){return!0}}())return Z(!1),void setTimeout((()=>{e(!0)}),500);!function(){if(!document.getElementById("DarkModeModal")){var e=document.createElement("div");e.id="DarkModeModal",e.className="modal fade",e.tabIndex="-1",e.setAttribute("aria-labelledby","darkModeModalLabel"),e.setAttribute("aria-hidden","true"),e.innerHTML=`\n      <div class="modal-dialog modal-lg">\n        <div class="modal-content" style="background-color: #2d3748; color: #e2e8f0; border: 1px solid #4a5568;">\n          <div class="modal-header" style="background-color: #2d3748; border-bottom: 1px solid #4a5568;">\n            <h1 class="modal-title fs-5" id="DarkModeModalTitle" style="color: #e2e8f0;">${chrome.i18n.getMessage("js_content_Modal_DarkModeTitle")}</h1>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1); opacity: 0.8;"></button>\n          </div>\n          <div class="modal-body" style="background-color: #2d3748;">\n            <div class="mb-3">\n              <p id="DarkModeModalMessage" style="color: #e2e8f0;">${chrome.i18n.getMessage("js_content_Modal_DarkModeMessage")}</p>\n            </div>\n            <div class="alert mb-3" role="alert" style="background-color: #975a16; border-color: #b7791f; color: #fbb6ce;">\n              <p id="DarkModeModalWarning" class="mb-0">${chrome.i18n.getMessage("js_content_Modal_DarkModeWarning")}</p>\n            </div>\n            <div class="form-check">\n              <input class="form-check-input" type="checkbox" id="DarkModeNoShowAgain" style="background-color: #4a5568; border-color: #718096;">\n              <label class="form-check-label" for="DarkModeNoShowAgain" style="color: #e2e8f0;">\n                ${chrome.i18n.getMessage("js_content_Modal_DarkModeCheckbox")}\n              </label>\n            </div>\n          </div>\n          <div class="modal-footer" style="background-color: #2d3748; border-top: 1px solid #4a5568;">\n            <button id="DarkModeModalCancel" type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="background-color: #4a5568; border-color: #4a5568; color: #e2e8f0;">${chrome.i18n.getMessage("js_content_Modal_DarkModeCancel")}</button>\n            <button id="DarkModeModalContinue" type="button" class="btn btn-primary" style="background-color: #3182ce; border-color: #3182ce; color: #ffffff;">${chrome.i18n.getMessage("js_content_Modal_DarkModeContinue")}</button>\n          </div>\n        </div>\n      </div>\n    `,document.body.insertBefore(e,document.body.firstChild)}}(),$("#DarkModeModalCancel").off("click").on("click",(function(){$("#DarkModeModal").modal("hide"),e(!1)})),$("#DarkModeModalContinue").off("click").on("click",(async function(){$("#DarkModeNoShowAgain").is(":checked")&&await async function(e){try{await L.set(W,e)}catch(e){}}(!0),$("#DarkModeModal").modal("hide"),Z(!1),setTimeout((()=>{e(!0)}),500)})),$("#DarkModeModal").modal("show")}))}function ne(){setTimeout((()=>{Z(!0)}),1e3)}}("undefined"==typeof w?w={}:w);